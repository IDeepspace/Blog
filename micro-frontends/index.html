<!DOCTYPE HTML><html lang="zh-CN"><head><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="keywords" content="微前端, Deepspace"><meta name="description" content="一、什么是微前端？微前端的概念由我司(ThoughtWorks)在2016年十一月份的技术雷达中被列为组织应评估的技术，后来又被提升为试用版，最后将其推广到 Adopt 中。
微前端是一种类似于微服务的架构。它将微服务的理念应用于浏览器端，"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><title>微前端 | Deepspace</title><link rel="icon" type="image/png" href="/favicon.png"><link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="/libs/materialize/css/materialize.min.css"><link rel="stylesheet" type="text/css" href="/libs/aos/aos.css"><link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css"><link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" type="text/css" href="/css/matery.css"><link rel="stylesheet" type="text/css" href="/css/my.css"><script src="/libs/jquery/jquery-2.2.0.min.js"></script><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head></head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="container"><div class="nav-wrapper"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><span></span> <span class="logo-span">Deepspace</span></a></div><a href="#" data-activates="mobile-nav" class="button-collapse"><i class="fa fa-navicon"></i></a><ul class="right"><li class="hide-on-med-and-down"><a href="/" class="waves-effect waves-light"><i class="fa fa-home"></i> <span>首页</span></a></li><li class="hide-on-med-and-down"><a href="/tags" class="waves-effect waves-light"><i class="fa fa-tags"></i> <span>标签</span></a></li><li class="hide-on-med-and-down"><a href="/categories" class="waves-effect waves-light"><i class="fa fa-bookmark"></i> <span>分类</span></a></li><li class="hide-on-med-and-down"><a href="/archives" class="waves-effect waves-light"><i class="fa fa-archive"></i> <span>归档</span></a></li><li class="hide-on-med-and-down"><a href="/about" class="waves-effect waves-light"><i class="fa fa-user-circle-o"></i> <span>关于</span></a></li><li><a id="toggleSearch" class="waves-effect waves-light"><i id="searchIcon" class="mdi-action-search"></i></a></li></ul><div class="side-nav" id="mobile-nav"><div class="mobile-head bg-color"><div class="logo-name">Deepspace</div><div class="logo-desc"> 凡事预 ？立 ：废</div></div><ul class="menu-list mobile-menu-list"><li><a href="/" class="waves-effect waves-light"><i class="fa fa-fw fa-home"></i> 首页</a></li><li><a href="/tags" class="waves-effect waves-light"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li><a href="/categories" class="waves-effect waves-light"><i class="fa fa-fw fa-bookmark"></i> 分类</a></li><li><a href="/archives" class="waves-effect waves-light"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li><a href="/about" class="waves-effect waves-light"><i class="fa fa-fw fa-user-circle-o"></i> 关于</a></li><li><div class="divider"></div></li><li><a href="https://github.com/IDeepspace" class="waves-effect waves-light" target="_blank"><i class="fa fa-github-square fa-fw"></i> Fork Me</a></li></ul><div class="social-link"><a href="https://github.com/IDeepspace" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fa fa-github"></i></a><a href="mailto:cxin1427@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fa fa-envelope-open"></i></a><a href="#!" class="tooltipped" data-tooltip="QQ: 690862036" data-position="top" data-delay="50"><i class="fa fa-qq"></i></a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fa fa-rss"></i></a></div></div></div></div><style>.nav-transparent .github-corner{display:none!important}.github-corner{position:absolute;z-index:10;top:0;right:0;border:0;transform:scale(1.1)}.github-corner svg{color:#202020;fill:#fff;height:64px;width:64px}.github-corner:hover .octo-arm{animation:a .56s ease-in-out}.github-corner .octo-arm{animation:none}@keyframes a{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}</style> <a href="https://github.com/IDeepspace" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50"><svg viewbox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a></nav></header><div class="bg-cover post-cover" style="background-image:url(/medias/featureimages/lighted.jpg)"><div class="container"><div class="row"><div class="col s12 m12 l12"><div class="brand"><div class="description center-align post-detail-title"> 微前端</div></div></div></div></div></div><main class="post-container content"><link rel="stylesheet" href="/libs/tocbot/tocbot.css"><style>#articleContent h1,#articleContent h2,#articleContent h3,#articleContent h4,#articleContent h5,#articleContent h6{padding-top:76px;margin-top:-76px}#articleContent h1{line-height:3.5rem}#articleContent h2{line-height:3.2rem}#articleContent h3{line-height:2.8rem}#articleContent h4{line-height:2.5rem}#articleContent h5{line-height:2.2rem}#articleContent h6{line-height:1.9rem}#articleContent :focus{outline:0}.toc-fixed{position:fixed;top:64px}.toc-widget{padding-left:20px}.toc-widget .toc-title{margin:35px 0 15px 0;padding-left:17px;font-size:1.5rem;font-weight:700;line-height:1.5rem}.toc-widget ol{padding:0;list-style:none}#toc-content ol{padding-left:10px}#toc-content ol li{padding-left:10px}#toc-content .toc-link:hover{color:#42b983;font-weight:700;text-decoration:underline}#toc-content .toc-link::before{background-color:transparent;max-height:25px}#toc-content .is-active-link{color:#42b983}#toc-content .is-active-link::before{background-color:#42b983}</style><div class="row"><div class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="article-tag"> <a href="/tags/微前端/" target="_blank"><span class="chip bg-color">微前端</span></a></div><div class="post-info"><span class="post-cate"><i class="fa fa-bookmark fa-fw icon-category"></i> <a href="/categories/FrontEnd/" class="post-category" target="_blank">FrontEnd</a></span><span class="post-date"><i class="fa fa-clock-o fa-fw"></i> 2019-06-24</span></div></div><hr><div class="card-content article-card-content"><div id="articleContent"><h3 id="一、什么是微前端？"><a href="#一、什么是微前端？" class="headerlink" title="一、什么是微前端？"></a>一、什么是微前端？</h3><p>微前端的概念由我司(<code>ThoughtWorks</code>)在2016年十一月份的<a href="https://www.thoughtworks.com/radar/techniques/micro-frontends" target="_blank" rel="noopener">技术雷达</a>中被列为组织应评估的技术，后来又被提升为试用版，最后将其推广到 <code>Adopt</code> 中。</p><p>微前端是一种类似于微服务的架构。它将微服务的理念应用于浏览器端，即将单页面前端应用由单一的单体应用转变为把多个小型前端应用聚合为一的应用。各个前端应用还可以独立开发，独立部署，这样我们也就实现了应用的自治。而划分的团队之间也可以自治，独立定义自己的命名规则、代码规范、技术栈、开发流程等。</p><a id="more"></a><h3 id="二、为什么需要微前端？"><a href="#二、为什么需要微前端？" class="headerlink" title="二、为什么需要微前端？"></a>二、为什么需要微前端？</h3><p>一个大型组织的组织架构、软件架构是在不断地发生变化的。其业务的不断发展会导致组织的应用不断地膨胀，进一步映射到软件架构上。当一个组织的部门已经过于庞大的时候，就会进一步将它细化。同理，软件的不同部分又被拆分到不同的部门之下。随着不同部门的业务发展，技术栈也会因此变得越来越难以统一，出现多样化。</p><p>而对于用户来说，会越来越厌倦同一家公司的软件出现在不同的应用上。用户厌倦之后，应用的获客成本就会变得越来越高，在这样的背景下，应用又再一次走向了聚合。最近几年，移动应用就出现了这样的趋势，我们拿支付宝来举例。</p><p>一家大的商业公司，都会提供一系列的应用，这些应用从某种程度上也可以反映这家公司的组织架构。但是在用户眼里，他们就是一家公司，他们就只应该有一个应用。就像支付宝，我们肯定希望只在一个 <code>App</code> 中进行各种操作，比如收付款、转账、理财、缴纳水电，以及现在的小程序等，当然不希望下载多个 <code>App</code> 来完成这些事情。</p><p><strong>相似的，这种趋势也在桌面 <code>Web</code> 出现，聚合成为客户端的一个技术趋势，实现前端聚合的就是微前端架构。</strong></p><p>现在，绝大多数的公司都已经采用前后端分离的架构和开发模式。分离降低了系统的复杂度，同时也提高了软件的开发效率。而随着业务的不断扩张，需求也不断扩大，应用又开始变得臃肿起来。既然应用变大了，我们就得继续拆分，拆分成更小的单元。所以，微前端的架构模式和理念也是基于此诞生。</p><p>如果你经历过一个遗留系统的项目开发，应该会有很深的体会。产品代码是使用一个老旧的前端框架搭建而成，当你想把新的框架应用到项目中的时候，却发现新技术栈的某些编译配置在当前代码库中无法使用；想在的产品代码库中构建一个响应式 <code>Web</code> 应用程序，却找不到一个合适的入口去进行代码集成。代码越来越臃肿，前进的脚步被往日堆积的技术债所阻碍。你可能会想到重写，但是对于一个遗留系统而言，在没有很清楚地弄明白它的业务细节之前，加上无法得到重写的 <code>support</code> 之前，是万万不敢轻举妄动的，也是无法进行的。<strong>解决遗留系统，是采用微前端方案最重要的原因。</strong></p><h3 id="三、微前端的技术拆分方式"><a href="#三、微前端的技术拆分方式" class="headerlink" title="三、微前端的技术拆分方式"></a>三、微前端的技术拆分方式</h3><p>从技术实践上来说，微前端可以采用以下几种方式进行：</p><ol><li>路由分发式。通过 <code>HTTP</code> 服务器的反向代理功能，将请求路由到对应的应用上。</li><li>前端微服务化。在不同的框架之上设计通信和加载机制，以在一个页面内加载对应的应用。</li><li>微应用。通过软件工程的方式，在部署构建环境之中，把多个独立的应用组合成一个单体应用。</li><li>微件化。开发一个新的构建系统，将部分业务功能构建成一个独立的 <code>chunk</code> 代码，使用时只需要远程加载即可。</li><li>前端容器化。将 <code>iframe</code> 作为容器来容纳其他前端应用。</li><li>应用组件化。借助于 <code>Web Components</code> 技术，来构建跨框架的前端应用。</li></ol><p>实施的方式虽然多，但都是依据场景而采用的。在某些场景下，可能没有合适的方式；而在某些场景下，则可以同时使用多种方案。下面我们看看上面这六种方式的具体实现。</p><h4 id="1-路由分发式"><a href="#1-路由分发式" class="headerlink" title="(1) 路由分发式"></a>(1) 路由分发式</h4><p>路由分发式微前端，即通过路由将不同的业务分发到不同的独立前端应用上。通常是通过 <code>HTTP</code> 服务器的反向代理来实现，也可以通过应用框架自带的路由来解决。</p><p><img src="https://github.com/IDeepspace/ImageHosting/raw/master/FrontEnd/micro-frontend-router.jpg" alt="路由分发式" style="zoom:67%"></p><p></p><p align="center">(图片来自网络)</p><br>路由分发式的架构应该是采用最多最容易的微前端方法。但是这种方式也有一个缺点：看上去更像是多个前端应用的聚合 —— 我们只是将这些不同的前端应用拼凑在一起，使它们看起来像一个完整的整体，但它们并非是一个整体。每当用户从 <code>A</code> 应用切换到 <code>B</code> 应用的时候，往往需要刷新一下页面，重新加载资源文件。<p></p><p>在这个架构中，我们只需要关注应用间的数据传递方式。通常，我们只需要将当前的用户状态从 <code>A</code> 应用传递到 <code>B</code> 应用即可。如果两个应用在同一个域里运行，就更加方便了，它们可以通过 <code>LocalStorage</code> 、<code>Cookies</code> 、<code>IndexedDB</code> 等方式共享数据。</p><blockquote><p>这里需要注意的是：在采用这种应用时，缺少了对应用状态的处理，需要用户重新登录，这种体验对用户来说相当不友好。</p></blockquote><h4 id="2-前端微服务化"><a href="#2-前端微服务化" class="headerlink" title="(2) 前端微服务化"></a>(2) 前端微服务化</h4><p>前端微服务化，是微服务架构在前端的实施，每个前端应用都是完全独立的（技术栈、开发、部署、构建）、自主运行的，最后通过模块化的方式组合出完整的前端应用，架构图如下：</p><p><img src="https://github.com/IDeepspace/ImageHosting/raw/master/FrontEnd/micro-frontend-microfrontend.jpg" alt="前端微服务化" style="zoom:50%"></p><p></p><p align="center">(图片来自网络)</p><br>采用这种方式，就意味着一个页面上同时存在两个及以上的前端应用在运行，而前面所提到的路由分发方案则是页面页面只有唯一一个应用。<p></p><p>当我们单击指向某个应用的路由时，会加载、运行对应的应用。而原有的一个或多个应用，仍然可以在页面上保持运行的状态。同时，这些应用可以使用的不同的技术栈来开发，如页面上可以同时运行 <code>React</code>、<code>Angular</code> <code>和 Vue</code> 框架开发的应用。</p><p>能够这样实施的原因是：不论是基于 <code>Web Components</code> 的 <code>Angular</code>，还是 <code>VirtualDOM</code> 的 <code>React</code>，现有的前端框架都离不开基本的 <code>HTML</code> 元素 <code>DOM</code> 。所以我们只需要做到如下两点：</p><ul><li>在页面合适的地方引入或者创建 <code>DOM</code>；</li><li>用户操作时，加载对应的应用（触发应用的启动），并能卸载应用。</li></ul><p>创建 <code>DOM</code> 比较容易解决，第二点却比较麻烦，特别是移除 <code>DOM</code> 和相应应用的监听。当我们拥有一个不同的技术栈时，我们需要有针对性地设计出一套这样的逻辑。同时，我们还需要保证应用间的第三方依赖之间不发生冲突。</p><h4 id="3-组合式集成：微应用化"><a href="#3-组合式集成：微应用化" class="headerlink" title="(3) 组合式集成：微应用化"></a>(3) 组合式集成：微应用化</h4><p>微应用化是指，在开发时应用都是以单一的、微小应用的形式存在的，而在运行时，则通过构建系统合并这些应用，并组合成一个新的应用，其架构如下图：</p><p><img src="https://github.com/IDeepspace/ImageHosting/raw/master/FrontEnd/micro-frontend-micro-app.jpg" alt="微应用化" style="zoom:77%"></p><p>微应用化大都是以软件工程的方式来完成前端应用的开发的，因此又可以称之为组合式集成。对于一个大型的前端应用来说，采用的架构方式往往是可以通过业务作为主目录的，然后在业务目录中放置相关的组件，同时拥有一些通用的共享模板，例如：</p><pre><code>|—— account
|—— dashboard
|—— reports
|—— ...
|__ shared
</code></pre><p>当我们开发一个这样的应用时，从目录结构上看，业务本身已经被拆分了。我们所要做的是：让每个模块都成为一个单独的项目，如将仪表盘功能提取出来，加上共享部分的代码、应用的基本脚手架，便可以成为一个单独的应用。拆分出每个模块之后，便只需要在构建的时候复制所有的模块到一个项目中，再进行集成构建。</p><p>微应用化与前端微服务化类似，在开发时都是独立应用的，在构建时又可以按照需要单独加载。如果以微前端的单独开发、单独部署、运行时聚合的基本思想来看，微应用化就是微前端的一种实践，只是使用微应用化意味着我们只用使用唯一的一种前端框架。大团队通常是不会同时支持多个前端框架的。</p><h4 id="4-微件化"><a href="#4-微件化" class="headerlink" title="(4) 微件化"></a>(4) 微件化</h4><p><strong>微件（widget），指的是一段可以直接嵌入在应用上运行的代码，它由开发人员预先编译好，在加载时不需要再做任何修改或者编译。</strong>而微前端下的微件化则指的是，每个业务团队编写自己的业务代码，并将编译好的代码部署（上传或者放置）到指定的服务器上，在运行时，我们只需要加载相应的业务模块即可。对应的，在更新代码的时候，我们只需要更新对应的模块即可。下图便是微件化的架构示意图：</p><p><img src="https://github.com/IDeepspace/ImageHosting/raw/master/FrontEnd/micro-front-micro-component.jpg" alt="微件化" style="zoom:67%"></p><p></p><p align="center">(图片来自网络)</p><br>在非单面应用时代，要实现微件化方案是一件特别容易的事。从远程加载来对应的 <code>JavaScript</code> 代码并在浏览器上执行，生成对应的组件嵌入到页面的相应部分。对于业务组件也是类似的，提前编写好我们的业务组件，当需要对应的组件时再响应和执行。在未来，我们也可以采用 <code>WebComponent</code> 技术来做这样的事情。<p></p><p>而在单页面应用时代，要实现微件化就没有那么容易了。为了支持微建化，我们需要做下面一些事情：</p><ul><li>持有一个完整的框架运行时及编译环境。这用于保证微件能征程使用，即可调用框架 <code>API</code> 等。</li><li>性能受影响。应用由提前编译变成运行时才编译，会造成一些性能方面的影响——具体视组件的大小而定。</li><li>提前规划依赖。如果一个新的微件想使用新的依赖，需要从上游编译引入。</li></ul><p>此外，我们还需要一个支持上述功能的构建系统，它用于构建一个独立的微件模块。这个微件的形式如下：</p><ul><li>分包构建出来的独立代码，如 <code>webpack</code> 构建出来的 <code>chunk</code> 。</li><li>使用 <code>DSL</code> 的方式编写出来的组件。</li></ul><p>为了实现这种方式，我们需要对前端的应用的构建系统进行修改，如 <code>webpack</code> ，使它可以支持构建出单个的代码段。这种方式的实施成本比微应用化成本高。</p><h4 id="5-前端容器：iframe"><a href="#5-前端容器：iframe" class="headerlink" title="(5) 前端容器：iframe"></a>(5) 前端容器：iframe</h4><p><code>iframe</code> 作为一个非常 “古老” 的，人人都觉得普通的技术，却一直很管用。它能有效地将另一个网页/单页面应用嵌入到当前页面中，两个页面间的 <code>CSS</code> 和 <code>JavaScript</code> 是相互隔离的——除去 iframe 父子通信部分的代码，它们之间的代码是完全不相互干扰的。<code>iframe</code> 便相当于是创建了一个全新的独立的宿主环境，类似于沙箱隔离，它意味着前端应用之间可以相互独立运行。</p><p>当然，采用 <code>iframe</code> 有几个重要的前提：</p><ul><li>网站不需要 <code>SEO</code> 支持；</li><li>设计相应的应用管理机制。</li></ul><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Book Store<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Welcome to Book Store!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>micro-frontend-container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">
      <span class="token keyword">const</span> microFrontendsByRoute <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">'/browse'</span><span class="token punctuation">:</span> <span class="token string">'https://browse.micro-frontend-demo.com/index.html'</span><span class="token punctuation">,</span>
        <span class="token string">'/order'</span><span class="token punctuation">:</span> <span class="token string">'https://order.micro-frontend-demo.com/index.html'</span><span class="token punctuation">,</span>
        <span class="token string">'/profile'</span><span class="token punctuation">:</span> <span class="token string">'https://profile.micro-frontend-demo.com/index.html'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>

      <span class="token keyword">const</span> iframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'micro-frontend-container'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      iframe<span class="token punctuation">.</span>src <span class="token operator">=</span> microFrontendsByRoute<span class="token punctuation">[</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>pathname<span class="token punctuation">]</span><span class="token punctuation">;</span>
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
</code></pre><h4 id="6-结合-Web-Components-构建"><a href="#6-结合-Web-Components-构建" class="headerlink" title="(6) 结合 Web Components 构建"></a>(6) 结合 Web Components 构建</h4><p><code>Web Components</code> 是一套不同的技术，允许开发者创建可重用的定制元素（它们的功能封装在代码之外），并且在 <code>web</code> 应用中使用它们。</p><p><img src="https://github.com/IDeepspace/ImageHosting/raw/master/FrontEnd/micro-frontend-web-component.jpg" alt="微件化" style="zoom:67%"></p><p></p><p align="center">(图片来自网络)</p><p></p><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Book Store!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Welcome to Book Store!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>

    <span class="token comment" spellcheck="true">&lt;!-- These scripts don't render anything immediately --></span>
    <span class="token comment" spellcheck="true">&lt;!-- Instead they each define a custom element type --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://browse.micro-frontend-demo.com/bundle.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://order.micro-frontend-demo.com/bundle.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://profile.micro-frontend-demo.com/bundle.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>micro-frontend-root<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">
      <span class="token comment" spellcheck="true">// These element types are defined by the above scripts</span>
      <span class="token keyword">const</span> webComponentsByRoute <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">'/'</span><span class="token punctuation">:</span> <span class="token string">'micro-frontend-browse-books'</span><span class="token punctuation">,</span>
        <span class="token string">'/order'</span><span class="token punctuation">:</span> <span class="token string">'micro-frontend-order-book'</span><span class="token punctuation">,</span>
        <span class="token string">'/profile'</span><span class="token punctuation">:</span> <span class="token string">'micro-frontend-profile'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> webComponentType <span class="token operator">=</span> webComponentsByRoute<span class="token punctuation">[</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>pathname<span class="token punctuation">]</span><span class="token punctuation">;</span>

      <span class="token comment" spellcheck="true">// Having determined the right web component custom element type,</span>
      <span class="token comment" spellcheck="true">// we now create an instance of it and attach it to the document</span>
      <span class="token keyword">const</span> root <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'micro-frontend-root'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> webComponent <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>webComponentType<span class="token punctuation">)</span><span class="token punctuation">;</span>
      root<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>webComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
</code></pre><p><code>Web Component</code> 于微前端中的应用，现在也正处于摸索阶段。</p><blockquote><p>参考：</p><ul><li>《前端架构 — 从入门到微前端》—— 黄峰达（Phodal）</li><li><a href="https://martinfowler.com/articles/micro-frontends.html" target="_blank" rel="noopener">https://martinfowler.com/articles/micro-frontends.html</a></li></ul></blockquote></div><hr><style>#reward{margin:40px 0;text-align:center}#reward .reward-link{font-size:1.88rem}#reward .btn-floating:hover{box-shadow:0 6px 12px rgba(0,0,0,.2),0 5px 15px rgba(0,0,0,.2)}#rewardModal{width:320px;height:350px}#rewardModal .reward-title{margin:15px auto;padding-bottom:5px}#rewardModal .modal-content{padding:10px}#rewardModal .close{position:absolute;right:15px;top:15px;color:rgba(0,0,0,.5);font-size:1.3rem;line-height:20px;cursor:pointer}#rewardModal .reward-tabs{margin:0 auto;width:210px}.reward-tabs .tabs{height:38px;margin:10px auto;padding-left:0}.reward-tabs .tabs .tab{height:38px;line-height:38px}.reward-tabs .tab a{color:#fff;background-color:#ccc}.reward-tabs .tab a:hover{color:#fff}.reward-tabs .wechat-tab .active{color:#fff;background-color:#22ab38}.reward-tabs .alipay-tab .active{color:#fff;background-color:#019fe8}.reward-tabs .reward-img{width:210px;height:210px}</style><div id="reward"> <a class="reward-link btn-floating btn-large waves-effect waves-light red">赏</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close"><i class="fa fa-close"></i></a><h4 class="reward-title">请我喝杯咖啡?</h4><div class="reward-content"><div class="reward-tabs"><ul class="tabs"><li class="tab wechat-tab waves-effect waves-light"><a class="active" href="#wechat">微信</a></li><li class="tab alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li></ul><div id="wechat"> <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码"></div><div id="alipay"> <img src="/medias/reward/alipay.png" class="reward-img" alt="支付宝打赏二维码"></div></div></div></div></div></div><script>$(function(){$("#reward .reward-link").on("click",function(){$("#rewardModal").openModal()}),$("#rewardModal .close").on("click",function(){$("#rewardModal").closeModal()})})</script><link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div></div><script src="/libs/share/js/social-share.min.js"></script><div class="reprint"><p> <span class="reprint-tip">转载请注明:</span> <a href="https://togoblog.cn" class="b-link-green">Deepspace</a><i class="fa fa-angle-right fa-lg fa-fw text-color"></i> <a href="/micro-frontends/" class="b-link-green">微前端</a></p></div></div></div><div class="article" data-aos="fade-up"><div class="card relate-article-wrapper"><header class="relate-article-header">相关文章&nbsp;<i class="fa fa-arrow-right"></i></header><div class="relate-post-box"><div class="relate-post"> <span>1、</span><a id="relate-post-link" href="/set-up-ci-env-with-circleci-and-github/">使用 CircleCI + Github 搭建持续集成环境</a></div><div class="relate-post"> <span>2、</span><a id="relate-post-link" href="/what-is-ci-cd/">Web 前端工程化（二） —— CI/CD</a></div><div class="relate-post"> <span>3、</span><a id="relate-post-link" href="/reflow-and-repaint/">浏览器的重排和重绘</a></div><div class="relate-post"> <span>4、</span><a id="relate-post-link" href="/mvc-map-mvvm/">谈谈前端开发中的 MVC、MVP、MVVM 模式</a></div><div class="relate-post"> <span>5、</span><a id="relate-post-link" href="/what-is-frontend-backend-separation/">Web 前端工程化（一） —— 什么是前后端分离？</a></div></div></div></div><div class="disqus-card card" data-aos="fade-up"><div id="disqus_thread" class="card-content"><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div><script type="text/javascript">
    disqus_config = function () {
        this.page.url = 'https://togoblog.cn/micro-frontends/';
        this.page.identifier = '/micro-frontends/';
        this.page.title = '微前端';
    };
    let disqus_shortname = 'https-togoblog-cn';

    (function () { // DON'T EDIT BELOW THIS LINE
        let d = document, s = d.createElement('script');
        // 如：s.src = 'https://Deepspace.disqus.com/embed.js';
        s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script></div></div><div class="col l3 hide-on-med-and-down"><div class="toc-widget"><div class="toc-title">目录</div><div id="toc-content"></div></div></div></div><script src="/libs/tocbot/tocbot.min.js"></script><script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingSelector: 'h2, h3, h4, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });
    });
</script></main><footer class="page-footer bg-color"><div class="container row center-align"><div class="col s12 m8 l8 copy-right"> <span>COPYRIGHT 2020 DEEPSPACE. ALL RIGHTS RESERVED.</span></div><div class="col s12 m4 l4 social-link"><a href="https://github.com/IDeepspace" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fa fa-github"></i></a><a href="mailto:cxin1427@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fa fa-envelope-open"></i></a><a href="#!" class="tooltipped" data-tooltip="QQ: 690862036" data-position="top" data-delay="50"><i class="fa fa-qq"></i></a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fa fa-rss"></i></a></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"> <span class="title">搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input" autofocus></div><div id="searchResult"></div></div></div><script src="/js/search.js"></script><script type="text/javascript">searchFunc("/search.xml","searchInput","searchResult")</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fa fa-angle-up"></i></a></div><script src="/libs/materialize/js/materialize.min.js"></script><script src="/libs/masonry/masonry.pkgd.min.js"></script><script src="/libs/aos/aos.js"></script><script src="/libs/scrollprogress/scrollProgress.min.js"></script><script src="/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="/js/matery.js"></script></body></html>