<!DOCTYPE HTML><html lang="zh-CN"><head><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="keywords" content="浏览器的重排和重绘, Deepspace"><meta name="description" content="浏览器的重排和重绘我们都知道，出于性能上的考虑，要尽可能地减少浏览器的重排（reflow）和重绘 (repaint)，那这样做的原因是什么呢？具体又应该如何做呢？下面我们一起来看看。
一、网页生成过程我们先来看看网页的生成过程，如下图：

"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><title>浏览器的重排和重绘 | Deepspace</title><link rel="icon" type="image/png" href="/favicon.png"><link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="/libs/materialize/css/materialize.min.css"><link rel="stylesheet" type="text/css" href="/libs/aos/aos.css"><link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css"><link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" type="text/css" href="/css/matery.css"><link rel="stylesheet" type="text/css" href="/css/my.css"><script src="/libs/jquery/jquery-2.2.0.min.js"></script><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head></head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="container"><div class="nav-wrapper"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><span></span> <span class="logo-span">Deepspace</span></a></div><a href="#" data-activates="mobile-nav" class="button-collapse"><i class="fa fa-navicon"></i></a><ul class="right"><li class="hide-on-med-and-down"><a href="/" class="waves-effect waves-light"><i class="fa fa-home"></i> <span>首页</span></a></li><li class="hide-on-med-and-down"><a href="/tags" class="waves-effect waves-light"><i class="fa fa-tags"></i> <span>标签</span></a></li><li class="hide-on-med-and-down"><a href="/categories" class="waves-effect waves-light"><i class="fa fa-bookmark"></i> <span>分类</span></a></li><li class="hide-on-med-and-down"><a href="/archives" class="waves-effect waves-light"><i class="fa fa-archive"></i> <span>归档</span></a></li><li class="hide-on-med-and-down"><a href="/about" class="waves-effect waves-light"><i class="fa fa-user-circle-o"></i> <span>关于</span></a></li><li><a id="toggleSearch" class="waves-effect waves-light"><i id="searchIcon" class="mdi-action-search"></i></a></li></ul><div class="side-nav" id="mobile-nav"><div class="mobile-head bg-color"><div class="logo-name">Deepspace</div><div class="logo-desc"> 凡事预 ？立 ：废</div></div><ul class="menu-list mobile-menu-list"><li><a href="/" class="waves-effect waves-light"><i class="fa fa-fw fa-home"></i> 首页</a></li><li><a href="/tags" class="waves-effect waves-light"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li><a href="/categories" class="waves-effect waves-light"><i class="fa fa-fw fa-bookmark"></i> 分类</a></li><li><a href="/archives" class="waves-effect waves-light"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li><a href="/about" class="waves-effect waves-light"><i class="fa fa-fw fa-user-circle-o"></i> 关于</a></li><li><div class="divider"></div></li><li><a href="https://github.com/IDeepspace" class="waves-effect waves-light" target="_blank"><i class="fa fa-github-square fa-fw"></i> Fork Me</a></li></ul><div class="social-link"><a href="https://github.com/IDeepspace" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fa fa-github"></i></a><a href="mailto:cxin1427@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fa fa-envelope-open"></i></a><a href="#!" class="tooltipped" data-tooltip="QQ: 690862036" data-position="top" data-delay="50"><i class="fa fa-qq"></i></a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fa fa-rss"></i></a></div></div></div></div><style>.nav-transparent .github-corner{display:none!important}.github-corner{position:absolute;z-index:10;top:0;right:0;border:0;transform:scale(1.1)}.github-corner svg{color:#202020;fill:#fff;height:64px;width:64px}.github-corner:hover .octo-arm{animation:a .56s ease-in-out}.github-corner .octo-arm{animation:none}@keyframes a{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}</style> <a href="https://github.com/IDeepspace" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50"><svg viewbox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a></nav></header><div class="bg-cover post-cover" style="background-image:url(/medias/featureimages/lighted.jpg)"><div class="container"><div class="row"><div class="col s12 m12 l12"><div class="brand"><div class="description center-align post-detail-title"> 浏览器的重排和重绘</div></div></div></div></div></div><main class="post-container content"><link rel="stylesheet" href="/libs/tocbot/tocbot.css"><style>#articleContent h1,#articleContent h2,#articleContent h3,#articleContent h4,#articleContent h5,#articleContent h6{padding-top:76px;margin-top:-76px}#articleContent h1{line-height:3.5rem}#articleContent h2{line-height:3.2rem}#articleContent h3{line-height:2.8rem}#articleContent h4{line-height:2.5rem}#articleContent h5{line-height:2.2rem}#articleContent h6{line-height:1.9rem}#articleContent :focus{outline:0}.toc-fixed{position:fixed;top:64px}.toc-widget{padding-left:20px}.toc-widget .toc-title{margin:35px 0 15px 0;padding-left:17px;font-size:1.5rem;font-weight:700;line-height:1.5rem}.toc-widget ol{padding:0;list-style:none}#toc-content ol{padding-left:10px}#toc-content ol li{padding-left:10px}#toc-content .toc-link:hover{color:#42b983;font-weight:700;text-decoration:underline}#toc-content .toc-link::before{background-color:transparent;max-height:25px}#toc-content .is-active-link{color:#42b983}#toc-content .is-active-link::before{background-color:#42b983}</style><div class="row"><div class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="article-tag"> <a href="/tags/重排/" target="_blank"><span class="chip bg-color">重排</span></a> <a href="/tags/重绘/" target="_blank"><span class="chip bg-color">重绘</span></a></div><div class="post-info"><span class="post-cate"><i class="fa fa-bookmark fa-fw icon-category"></i> <a href="/categories/FrontEnd/" class="post-category" target="_blank">FrontEnd</a></span><span class="post-date"><i class="fa fa-clock-o fa-fw"></i> 2018-11-01</span></div></div><hr><div class="card-content article-card-content"><div id="articleContent"><h2 id="浏览器的重排和重绘"><a href="#浏览器的重排和重绘" class="headerlink" title="浏览器的重排和重绘"></a>浏览器的重排和重绘</h2><p>我们都知道，出于性能上的考虑，要尽可能地减少浏览器的重排（<code>reflow</code>）和重绘 (<code>repaint</code>)，那这样做的原因是什么呢？具体又应该如何做呢？下面我们一起来看看。</p><h3 id="一、网页生成过程"><a href="#一、网页生成过程" class="headerlink" title="一、网页生成过程"></a>一、网页生成过程</h3><p>我们先来看看网页的生成过程，如下图：</p><p><img src="https://github.com/IDeepspace/ImageHosting/raw/master/FrontEnd/reflow-and-repaint.png" alt="GUI" style="zoom:87%"></p><p align="center">（图片来自网络）</p><p>在这个过程中：</p><ol><li><code>HTML</code> 被 <code>HTML</code> 解析器解析成 <code>DOM</code> 树</li><li><code>CSS</code> 则被 <code>CSS</code> 解析器解析成 <code>CSSOM</code> 树</li><li>结合 <code>DOM</code> 树和 <code>CSSOM</code> 树，生成一棵渲染树（<code>Render Tree</code>）</li><li>生成布局（<code>flow</code>），即将所有渲染树的所有节点进行平面合成</li><li>将布局绘制（<code>paint</code>）在屏幕上</li></ol><p>其中，第 4 步和第 5 步是最耗时的部分，这两步合起来就是我们通常所说的<strong>渲染</strong>。</p><p><strong>在网页生成的过程中，至少会渲染一次；并且，在用户操作界面的过程中，还会不断地重新渲染。也就是会不断地发生重排和重绘。</strong></p><h3 id="二、重排和重绘的概念"><a href="#二、重排和重绘的概念" class="headerlink" title="二、重排和重绘的概念"></a>二、重排和重绘的概念</h3><h4 id="1、重排"><a href="#1、重排" class="headerlink" title="1、重排"></a>1、重排</h4><p>当渲染树 <code>Render tree</code> 中的一部分（或全部）因为 <code>DOM</code> 的变化影响了元素的几何信息（<code>DOM</code> 对象的位置和尺寸大小），浏览器需要重新计算元素的几何属性，并将其安放在界面中的正确位置，这个过程就称为重排（<code>reflow</code>），重排也叫作<strong>回流</strong>。</p><p>每个页面至少需要一次重排，发生在页面第一次加载的时候。</p><h4 id="2、重绘"><a href="#2、重绘" class="headerlink" title="2、重绘"></a>2、重绘</h4><p>当渲染树 <code>Render tree</code> 中的一些元素需要更新属性，而这些属性<strong>只是影响元素的外观，而没有影响到布局</strong>，例如改变 <code>visibility</code>、<code>outline</code>、背景色等属性，<strong>浏览器会根据元素的新属性重新绘制，使元素呈现新的外观</strong>，这个过程就称为<strong>重绘（<code>repaint</code>）</strong>。</p><h4 id="3、重排与重绘的关系"><a href="#3、重排与重绘的关系" class="headerlink" title="3、重排与重绘的关系"></a>3、重排与重绘的关系</h4><p><strong>重绘不会引起重排，但重排一定会引起重绘</strong>。一个元素的重排通常会带来一系列的反应，甚至触发整个文档的重排和重绘，性能代价是高昂的。</p><h3 id="三、什么情况会触发重排和重绘？"><a href="#三、什么情况会触发重排和重绘？" class="headerlink" title="三、什么情况会触发重排和重绘？"></a>三、什么情况会触发重排和重绘？</h3><p><strong>任何关于用来构建渲染树的信息改变，都会导致一次重排或重绘。</strong></p><h4 id="1、触发重排的条件"><a href="#1、触发重排的条件" class="headerlink" title="1、触发重排的条件"></a>1、触发重排的条件</h4><ul><li><p>页面渲染初始化时；（这个无法避免）</p></li><li><p>浏览器窗口改变尺寸；</p></li><li><p>元素尺寸改变时；</p></li><li><p>元素位置改变时；</p></li><li><p>元素内容改变时；</p></li><li><p>添加或删除可见的 <code>DOM</code> 元素时。</p></li></ul><h4 id="2、常见的引起重绘的属性"><a href="#2、常见的引起重绘的属性" class="headerlink" title="2、常见的引起重绘的属性"></a>2、常见的引起重绘的属性</h4><ul><li><code>color</code></li><li><code>border-style</code></li><li><code>visibility</code></li><li><code>background</code></li><li><code>text-decoration</code></li><li><code>background-image</code></li><li><code>background-position</code></li><li><code>background-repeat</code></li><li><code>outline-color</code></li><li><code>outline</code></li><li><code>outline-style</code></li><li><code>border-radius</code></li><li><code>outline-width</code></li><li><code>box-shadow</code></li><li><code>background-size</code></li></ul><h4 id="3、注意"><a href="#3、注意" class="headerlink" title="3、注意"></a>3、注意</h4><ul><li>通过 <code>display: none</code> 隐藏一个 <code>DOM</code> 节点，会触发重排和重绘；</li><li>通过 <code>visibility: hidden</code> 隐藏一个 <code>DOM</code> 节点，只触发重绘，因为没有几何变化。</li></ul><h3 id="四、浏览器的渲染队列"><a href="#四、浏览器的渲染队列" class="headerlink" title="四、浏览器的渲染队列"></a>四、浏览器的渲染队列</h3><p>以下代码将会触发几次渲染？</p><pre class="language-javascript"><code class="language-javascript">div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token string">'10px'</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">'10px'</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token string">'20px'</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token string">'20px'</span><span class="token punctuation">;</span>
</code></pre><p>根据前面的描述，这段代码理论上会触发4次重排+重绘，因为每一次都改变了元素的几何属性。</p><p>但实际上最后只触发了一次重排，这都得益于浏览器的<strong>渲染队列机制：</strong></p><p>当我们修改了元素的几何属性，导致浏览器触发重排或重绘时，它会把该操作放进渲染队列，等到队列中的操作到了<strong>一定的数量或者到了一定的时间间隔</strong>时，浏览器就会批量执行这些操作。</p><p>但是如果我们像下面这样：</p><pre class="language-javascript"><code class="language-javascript">div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token string">'10px'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>div<span class="token punctuation">.</span>offsetLeft<span class="token punctuation">)</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">'10px'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>div<span class="token punctuation">.</span>offsetTop<span class="token punctuation">)</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token string">'20px'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>div<span class="token punctuation">.</span>offsetWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token string">'20px'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>div<span class="token punctuation">.</span>offsetHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>这段代码就会触发4次重排+重绘，因为在 <code>console</code> 中请求了这几个样式信息，无论何时浏览器都会立即执行渲染队列的任务（<strong>强制刷新队列</strong>），即使该值与操作中修改的值没关联。</p><p><strong>强制刷新队列的 <code>style</code> 样式请求：</strong></p><ul><li><p><code>offsetTop</code>、<code>offsetLeft</code>、<code>offsetWidth</code>、<code>offsetHeight</code></p></li><li><p><code>scrollTop</code>、<code>scrollLeft</code>、<code>scrollWidth</code>、<code>scrollHeight</code></p></li><li><p><code>clientTop</code>、<code>clientLeft</code>、<code>clientWidth</code>、<code>clientHeight</code></p></li><li><p><code>getComputedStyle()</code>、 或者 <code>IE</code> 的 <code>currentStyle</code></p></li></ul><p>我们在开发中应当避免这些能够强制刷新队列的操作。</p><h3 id="五、优化重排"><a href="#五、优化重排" class="headerlink" title="五、优化重排"></a>五、优化重排</h3><h4 id="1、读写分离"><a href="#1、读写分离" class="headerlink" title="1、读写分离"></a>1、读写分离</h4><p>还是拿上面的强制刷新队列的例子，如果我们改成这样：</p><pre class="language-javascript"><code class="language-javascript">div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token string">'10px'</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">'10px'</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token string">'20px'</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token string">'20px'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>div<span class="token punctuation">.</span>offsetLeft<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>div<span class="token punctuation">.</span>offsetTop<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>div<span class="token punctuation">.</span>offsetWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>div<span class="token punctuation">.</span>offsetHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>这次只触发了一次重排，因为：在第一个 <code>console</code> 的时候，浏览器把之前上面四个写操作的渲染队列都给清空了；剩下的 <code>console</code>，因为渲染队列本来就是空的，所以并没有触发重排，仅仅拿值而已。</p><h4 id="2、样式集中改变"><a href="#2、样式集中改变" class="headerlink" title="2、样式集中改变"></a>2、样式集中改变</h4><p>将多次改变样式属性的操作合并成一次操作，减少 <code>DOM</code> 访问</p><pre class="language-javascript"><code class="language-javascript">div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token string">'10px'</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">'10px'</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token string">'20px'</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token string">'20px'</span><span class="token punctuation">;</span>
</code></pre><p>优化：</p><pre class="language-javascript"><code class="language-javascript">el<span class="token punctuation">.</span>className <span class="token operator">+</span><span class="token operator">=</span> <span class="token string">" className"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 直接改变 class</span>
</code></pre><h4 id="3、离线操作"><a href="#3、离线操作" class="headerlink" title="3、离线操作"></a>3、离线操作</h4><p>如果要批量添加 <code>DOM</code>，可以让要操作的元素进行「离线处理」，处理完后一起更新。离线处理的意思是：</p><ul><li><p>隐藏要操作的 <code>DOM</code></p><p>在要操作 <code>DOM</code> 之前，通过 <code>display</code> 属性隐藏 <code>DOM</code>，当操作完成之后，再将元素的 <code>display</code> 属性为可见，因为不可见的元素不会触发重排和重绘。</p></li><li><p>通过使用 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/DocumentFragment" target="_blank" rel="noopener">DocumentFragment</a> 创建一个<code>DOM</code> 碎片，在它上面批量操作 <code>DOM</code>，操作完成之后，再添加到文档中，<strong>这样只会触发一次重排</strong>。</p></li></ul><h4 id="4、position-属性的应用"><a href="#4、position-属性的应用" class="headerlink" title="4、position 属性的应用"></a>4、<code>position</code> 属性的应用</h4><p>将需要多次重排的元素，<code>position</code> 属性设为 <code>absolute</code> 或 <code>fixed</code>，这样此元素就脱离了文档流，它的变化不会影响到其他元素。例如有动画效果的元素就最好设置为绝对定位。</p><h4 id="5、在内存中构建"><a href="#5、在内存中构建" class="headerlink" title="5、在内存中构建"></a>5、在内存中构建</h4><p>在内存中多次操作节点，完成后再添加到文档中去。例如要异步获取表格数据，渲染到页面。可以先取得数据后在内存中构建整个表格的 <code>html</code> 片段，再一次性添加到文档中去，而不是直接操作 <code>DOM</code>，循环添加每一行。</p><h3 id="六、虚拟-DOM"><a href="#六、虚拟-DOM" class="headerlink" title="六、虚拟 DOM"></a>六、虚拟 DOM</h3><p>由于重排和重绘的问题，当页面变得复杂的时候，频繁地操作 <code>DOM</code> 会造成很大的性能开销。</p><p>在 <code>JQuery</code> 出现之前，我们都是直接操作 <code>DOM</code> 结构，这种方法复杂度高，兼容性也较差。<code>JQuery</code> 对于操作 <code>DOM</code> 的 <code>API</code> 封装是非常强大的，操作 <code>DOM</code> 变得简单了很多，同时也帮我们处理了兼容性问题。但是这依旧不是很好的方案，性能问题依然存在，所以像 <code>React</code>、<code>Vue</code> 等框架，引入了虚拟 <code>DOM</code>（<code>Virtual DOM</code>）的概念。</p><p><code>DOM</code> 很慢，但是 <code>JavaScript</code> 很快，虚拟 <code>DOM</code> 使用 <code>JavaScript</code> 对象表示 <code>DOM</code> 节点。<code>DOM</code> 节点包括标签、属性和子节点。</p><p><code>React</code> 在内存中生成维护一个跟真实 <code>DOM</code> 一样的虚拟 <code>DOM</code> 树，在改动完组件后，会再生成一个新得 <code>DOM</code>，<code>React</code> 会把新虚拟 <code>DOM</code> 跟原虚拟 <code>DOM</code> 进行比对，找出两个<code>DOM</code> 不同的地方（<code>diff</code>） ，然后把 <code>diff</code> 放到队列里面，最后批量更新 <code>diff</code> 到真实 <code>DOM</code> 上。所以，最终真实 <code>DOM</code> 就只更新了<code>diff</code> 部分，提高了渲染速度。但是这样也有一些缺点，首次渲染 <code>DOM</code> 时候由于多了一层虚拟 <code>DOM</code> 计算，所以比 <code>html</code> 渲染慢。</p></div><hr><style>#reward{margin:40px 0;text-align:center}#reward .reward-link{font-size:1.88rem}#reward .btn-floating:hover{box-shadow:0 6px 12px rgba(0,0,0,.2),0 5px 15px rgba(0,0,0,.2)}#rewardModal{width:320px;height:350px}#rewardModal .reward-title{margin:15px auto;padding-bottom:5px}#rewardModal .modal-content{padding:10px}#rewardModal .close{position:absolute;right:15px;top:15px;color:rgba(0,0,0,.5);font-size:1.3rem;line-height:20px;cursor:pointer}#rewardModal .reward-tabs{margin:0 auto;width:210px}.reward-tabs .tabs{height:38px;margin:10px auto;padding-left:0}.reward-tabs .tabs .tab{height:38px;line-height:38px}.reward-tabs .tab a{color:#fff;background-color:#ccc}.reward-tabs .tab a:hover{color:#fff}.reward-tabs .wechat-tab .active{color:#fff;background-color:#22ab38}.reward-tabs .alipay-tab .active{color:#fff;background-color:#019fe8}.reward-tabs .reward-img{width:210px;height:210px}</style><div id="reward"> <a class="reward-link btn-floating btn-large waves-effect waves-light red">赏</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close"><i class="fa fa-close"></i></a><h4 class="reward-title">请我喝杯咖啡?</h4><div class="reward-content"><div class="reward-tabs"><ul class="tabs"><li class="tab wechat-tab waves-effect waves-light"><a class="active" href="#wechat">微信</a></li><li class="tab alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li></ul><div id="wechat"> <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码"></div><div id="alipay"> <img src="/medias/reward/alipay.png" class="reward-img" alt="支付宝打赏二维码"></div></div></div></div></div></div><script>$(function(){$("#reward .reward-link").on("click",function(){$("#rewardModal").openModal()}),$("#rewardModal .close").on("click",function(){$("#rewardModal").closeModal()})})</script><link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div></div><script src="/libs/share/js/social-share.min.js"></script><div class="reprint"><p> <span class="reprint-tip">转载请注明:</span> <a href="https://togoblog.cn" class="b-link-green">Deepspace</a><i class="fa fa-angle-right fa-lg fa-fw text-color"></i> <a href="/reflow-and-repaint/" class="b-link-green">浏览器的重排和重绘</a></p></div></div></div><div class="article" data-aos="fade-up"><div class="card relate-article-wrapper"><header class="relate-article-header">相关文章&nbsp;<i class="fa fa-arrow-right"></i></header><div class="relate-post-box"><div class="relate-post"> <span>1、</span><a id="relate-post-link" href="/set-up-ci-env-with-circleci-and-github/">使用 CircleCI + Github 搭建持续集成环境</a></div><div class="relate-post"> <span>2、</span><a id="relate-post-link" href="/what-is-frontend-backend-separation/">Web 前端工程化（一） —— 什么是前后端分离？</a></div><div class="relate-post"> <span>3、</span><a id="relate-post-link" href="/what-is-ci-cd/">Web 前端工程化（二） —— CI/CD</a></div><div class="relate-post"> <span>4、</span><a id="relate-post-link" href="/mvc-map-mvvm/">谈谈前端开发中的 MVC、MVP、MVVM 模式</a></div><div class="relate-post"> <span>5、</span><a id="relate-post-link" href="/micro-frontends/">微前端</a></div></div></div></div><div class="disqus-card card" data-aos="fade-up"><div id="disqus_thread" class="card-content"><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div><script type="text/javascript">
    disqus_config = function () {
        this.page.url = 'https://togoblog.cn/reflow-and-repaint/';
        this.page.identifier = '/reflow-and-repaint/';
        this.page.title = '浏览器的重排和重绘';
    };
    let disqus_shortname = 'https-togoblog-cn';

    (function () { // DON'T EDIT BELOW THIS LINE
        let d = document, s = d.createElement('script');
        // 如：s.src = 'https://Deepspace.disqus.com/embed.js';
        s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script></div></div><div class="col l3 hide-on-med-and-down"><div class="toc-widget"><div class="toc-title">目录</div><div id="toc-content"></div></div></div></div><script src="/libs/tocbot/tocbot.min.js"></script><script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingSelector: 'h2, h3, h4, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });
    });
</script></main><footer class="page-footer bg-color"><div class="container row center-align"><div class="col s12 m8 l8 copy-right"> <span>COPYRIGHT 2020 DEEPSPACE. ALL RIGHTS RESERVED.</span></div><div class="col s12 m4 l4 social-link"><a href="https://github.com/IDeepspace" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fa fa-github"></i></a><a href="mailto:cxin1427@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fa fa-envelope-open"></i></a><a href="#!" class="tooltipped" data-tooltip="QQ: 690862036" data-position="top" data-delay="50"><i class="fa fa-qq"></i></a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fa fa-rss"></i></a></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"> <span class="title">搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input" autofocus></div><div id="searchResult"></div></div></div><script src="/js/search.js"></script><script type="text/javascript">searchFunc("/search.xml","searchInput","searchResult")</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fa fa-angle-up"></i></a></div><script src="/libs/materialize/js/materialize.min.js"></script><script src="/libs/masonry/masonry.pkgd.min.js"></script><script src="/libs/aos/aos.js"></script><script src="/libs/scrollprogress/scrollProgress.min.js"></script><script src="/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="/js/matery.js"></script></body></html>