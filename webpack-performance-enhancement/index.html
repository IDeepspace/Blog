<!DOCTYPE HTML><html lang="zh-CN"><head><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="keywords" content="Webpack 性能优化, Deepspace"><meta name="description" content="Wepack 性能优化本篇文章我们一起来看看 Webpack 的性能优化相关内容。在这之前，再简单介绍下 Webpack 的一些相关概念。
一、webpack 是什么？webpack 是一种前端资源构建工具，它是一个静态模块打包器（modu"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><title>Webpack 性能优化 | Deepspace</title><link rel="icon" type="image/png" href="/favicon.png"><link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="/libs/materialize/css/materialize.min.css"><link rel="stylesheet" type="text/css" href="/libs/aos/aos.css"><link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css"><link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" type="text/css" href="/css/matery.css"><link rel="stylesheet" type="text/css" href="/css/my.css"><script src="/libs/jquery/jquery-2.2.0.min.js"></script><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head></head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="container"><div class="nav-wrapper"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><span></span> <span class="logo-span">Deepspace</span></a></div><a href="#" data-activates="mobile-nav" class="button-collapse"><i class="fa fa-navicon"></i></a><ul class="right"><li class="hide-on-med-and-down"><a href="/" class="waves-effect waves-light"><i class="fa fa-home"></i> <span>首页</span></a></li><li class="hide-on-med-and-down"><a href="/tags" class="waves-effect waves-light"><i class="fa fa-tags"></i> <span>标签</span></a></li><li class="hide-on-med-and-down"><a href="/categories" class="waves-effect waves-light"><i class="fa fa-bookmark"></i> <span>分类</span></a></li><li class="hide-on-med-and-down"><a href="/archives" class="waves-effect waves-light"><i class="fa fa-archive"></i> <span>归档</span></a></li><li class="hide-on-med-and-down"><a href="/about" class="waves-effect waves-light"><i class="fa fa-user-circle-o"></i> <span>关于</span></a></li><li><a id="toggleSearch" class="waves-effect waves-light"><i id="searchIcon" class="mdi-action-search"></i></a></li></ul><div class="side-nav" id="mobile-nav"><div class="mobile-head bg-color"><div class="logo-name">Deepspace</div><div class="logo-desc"> 凡事预 ？立 ：废</div></div><ul class="menu-list mobile-menu-list"><li><a href="/" class="waves-effect waves-light"><i class="fa fa-fw fa-home"></i> 首页</a></li><li><a href="/tags" class="waves-effect waves-light"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li><a href="/categories" class="waves-effect waves-light"><i class="fa fa-fw fa-bookmark"></i> 分类</a></li><li><a href="/archives" class="waves-effect waves-light"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li><a href="/about" class="waves-effect waves-light"><i class="fa fa-fw fa-user-circle-o"></i> 关于</a></li><li><div class="divider"></div></li><li><a href="https://github.com/IDeepspace" class="waves-effect waves-light" target="_blank"><i class="fa fa-github-square fa-fw"></i> Fork Me</a></li></ul><div class="social-link"><a href="https://github.com/IDeepspace" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fa fa-github"></i></a><a href="mailto:cxin1427@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fa fa-envelope-open"></i></a><a href="#!" class="tooltipped" data-tooltip="QQ: 690862036" data-position="top" data-delay="50"><i class="fa fa-qq"></i></a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fa fa-rss"></i></a></div></div></div></div><style>.nav-transparent .github-corner{display:none!important}.github-corner{position:absolute;z-index:10;top:0;right:0;border:0;transform:scale(1.1)}.github-corner svg{color:#202020;fill:#fff;height:64px;width:64px}.github-corner:hover .octo-arm{animation:a .56s ease-in-out}.github-corner .octo-arm{animation:none}@keyframes a{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}</style> <a href="https://github.com/IDeepspace" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50"><svg viewbox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a></nav></header><div class="bg-cover post-cover" style="background-image:url(/medias/featureimages/lighted.jpg)"><div class="container"><div class="row"><div class="col s12 m12 l12"><div class="brand"><div class="description center-align post-detail-title"> Webpack 性能优化</div></div></div></div></div></div><main class="post-container content"><link rel="stylesheet" href="/libs/tocbot/tocbot.css"><style>#articleContent h1,#articleContent h2,#articleContent h3,#articleContent h4,#articleContent h5,#articleContent h6{padding-top:76px;margin-top:-76px}#articleContent h1{line-height:3.5rem}#articleContent h2{line-height:3.2rem}#articleContent h3{line-height:2.8rem}#articleContent h4{line-height:2.5rem}#articleContent h5{line-height:2.2rem}#articleContent h6{line-height:1.9rem}#articleContent :focus{outline:0}.toc-fixed{position:fixed;top:64px}.toc-widget{padding-left:20px}.toc-widget .toc-title{margin:35px 0 15px 0;padding-left:17px;font-size:1.5rem;font-weight:700;line-height:1.5rem}.toc-widget ol{padding:0;list-style:none}#toc-content ol{padding-left:10px}#toc-content ol li{padding-left:10px}#toc-content .toc-link:hover{color:#42b983;font-weight:700;text-decoration:underline}#toc-content .toc-link::before{background-color:transparent;max-height:25px}#toc-content .is-active-link{color:#42b983}#toc-content .is-active-link::before{background-color:#42b983}</style><div class="row"><div class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="article-tag"> <a href="/tags/Webpack/" target="_blank"><span class="chip bg-color">Webpack</span></a></div><div class="post-info"><span class="post-cate"><i class="fa fa-bookmark fa-fw icon-category"></i> <a href="/categories/FrontEnd/" class="post-category" target="_blank">FrontEnd</a></span><span class="post-date"><i class="fa fa-clock-o fa-fw"></i> 2019-11-28</span></div></div><hr><div class="card-content article-card-content"><div id="articleContent"><h2 id="Wepack-性能优化"><a href="#Wepack-性能优化" class="headerlink" title="Wepack 性能优化"></a>Wepack 性能优化</h2><p>本篇文章我们一起来看看 <code>Webpack</code> 的性能优化相关内容。在这之前，再简单介绍下 <code>Webpack</code> 的一些相关概念。</p><h3 id="一、webpack-是什么？"><a href="#一、webpack-是什么？" class="headerlink" title="一、webpack 是什么？"></a>一、webpack 是什么？</h3><p><code>webpack</code> 是一种前端资源构建工具，它是一个<strong>静态模块打包器</strong>（<code>module bundler</code>）。在 <code>webpack</code> 中，前端的所有资源文件（<code>javascript/json/css/img/less/...</code>）都会作为模块处理，当 <code>webpack</code> 处理应用程序时,它会递归地构建一个依赖关系图（<code>dependency graph</code>），其中包含应用程序需要的每个模块，然后将所有这些模块打包成一个或多个 <code>bundle</code>。</p><p><img src="https://github.com/IDeepspace/ImageHosting/raw/master/FrontEnd/webpack.png" alt="image-20200511205102019" style="zoom:50%"></p><p></p><p align="center">（图片来自网络）</p><br><a id="more"></a><p></p><h4 id="1、基本功能"><a href="#1、基本功能" class="headerlink" title="1、基本功能"></a>1、基本功能</h4><ul><li><strong>代码转换</strong>：将 <code>TypeScript</code> 编译成 <code>JavaScript</code>、<code>SCSS</code> 编译成 <code>CSS</code> 等。</li><li><strong>文件优化</strong>：压缩 <code>JavaScript</code>、<code>CSS</code>、<code>HTML</code> 代码，压缩合并图片等。</li><li><strong>代码分割</strong>：提取多个页面的公共代码、提取首屏不需要执行部分的代码让其异步加载。</li><li><strong>模块合并</strong>：在采用模块化的项目里会有很多个模块和文件，需要构建功能把模块分类合并成一个文件。</li><li><strong>自动刷新</strong>：监听本地源代码的变化，自动重新构建、刷新浏览器。</li><li><strong>代码校验</strong>：在代码被提交到仓库前需要校验代码是否符合规范，以及单元测试是否通过。</li><li><strong>自动发布</strong>：更新完代码后，自动构建出线上发布代码并传输给发布系统。</li></ul><h4 id="2、打包原理"><a href="#2、打包原理" class="headerlink" title="2、打包原理"></a>2、打包原理</h4><ul><li>识别入口文件，分析代码，获取模块依赖，并且将代码打包为浏览器可以识别的代码；</li><li>递归地构建一个依赖关系图（<code>dependency graph</code>），其中包含应用程序需要的每个模块，然后将所有这些模块打包成一个或多个 <code>bundle</code>。</li></ul><h3 id="二、核心概念"><a href="#二、核心概念" class="headerlink" title="二、核心概念"></a>二、核心概念</h3><h4 id="1、entry"><a href="#1、entry" class="headerlink" title="1、entry"></a>1、entry</h4><p>入口（<code>Entry</code>）：指示 <code>webpack</code> 应该以哪个文件（模块）为入口起点开始打包，分析构建内部依赖图。</p><h4 id="2、output"><a href="#2、output" class="headerlink" title="2、output"></a>2、output</h4><p>输出（<code>Output</code>）：指示 <code>Webpack</code> 打包后的资源（ <code>bundles</code> ）输出到哪里去，以及如何命名。基本上，整个应用程序结构,都会被编译到你指定的输出路径的文件夹中。</p><h4 id="3、module"><a href="#3、module" class="headerlink" title="3、module"></a>3、module</h4><p>模块，在 <code>Webpack</code> 里一切皆模块，<strong>一个模块对应着一个文件</strong>。<code>Webpack</code> 会从配置的 <code>entry</code> 开始递归找出所有依赖的模块。</p><h4 id="4、chunk"><a href="#4、chunk" class="headerlink" title="4、chunk"></a>4、chunk</h4><p>代码块，一个 <code>chunk</code> 由多个模块组合而成，用于<strong>代码合并与分割</strong>。</p><h4 id="5、loader"><a href="#5、loader" class="headerlink" title="5、loader"></a>5、loader</h4><p><strong><code>Loader</code> 是模块转换器，用于把模块原内容按照需求转换成新内容</strong>。例如：我们会使用 <code>Loader</code> 让 <code>Webpack</code> 能够去处理那些非 <code>JavaScript</code> 文件（<code>Webpack 自身只理解 JavaScript</code>）。然后就可以利用 <code>webpack</code> 的打包能力，对它们进行处理。</p><h4 id="6、plugins"><a href="#6、plugins" class="headerlink" title="6、plugins"></a>6、plugins</h4><p>用于扩展 <code>Webpack</code> 功能，在 <code>Webpack</code> 构建流程中的特定时机会广播出对应的事件，插件可以监听这些事件的发生，在特定时机做对应的事情。</p><h4 id="7、mode"><a href="#7、mode" class="headerlink" title="7、mode"></a>7、mode</h4><p>模式（<code>Mode</code>）指示 <code>Webpack</code> 使用相应模式的配置，是使用开发模式（<code>development</code>）还是生产模式（<code>production</code>）。</p><ul><li>开发模式<ul><li>方便于浏览器调试的工具；</li><li>可以快速地对增加的内容进行编译；</li><li>提供了更精确、更有用的运行时错误提示机制。</li></ul></li><li>生产模式<ul><li>自动压缩构建输出的文件</li><li>快速的运行时处理</li><li>不暴露源代码和源文件的路径</li><li>快速的静态资源输出</li></ul></li></ul><h4 id="8、devServer"><a href="#8、devServer" class="headerlink" title="8、devServer"></a>8、devServer</h4><p>通过 <code>devServer</code> 启动的 <code>Webpack</code> 会开启监听模式，当发生变化时重新执行构建，然后通知 <code>devServer</code> 会让 <code>Webpack</code> 在构建出的 <code>JavaScript</code> 代码里注入一个代理客户端用于控制网页，网页和 <code>devServer</code> 之间通过 <code>WebSocket</code> 协议通信，以方便 <code>devServer</code> 主动向客户端发送命令。<code>devServer</code> 在收到来自 <code>Webpack</code> 的文件变化通知时，通过注入的客户端控制网页刷新。</p><ul><li>提供 <code>HTTP</code> 服务，而非使用本地文件预览</li><li>监听文件的变化并自动刷新网页，做到实时预览</li><li>支持 <code>SourceMap</code> 方便调试</li></ul><h3 id="三、构建流程"><a href="#三、构建流程" class="headerlink" title="三、构建流程"></a>三、构建流程</h3><p><code>Webpack</code> 的运行流程是一个串行的过程，从启动到结束会依次执行以下流程 :</p><ul><li><p>从 <code>entry</code> 里配置的 <code>module</code> 开始递归解析 <code>entry</code> 依赖的所有 <code>module</code></p></li><li><p>每找到一个 <code>module</code>，就会根据配置的 <code>loader</code> 去找对应的转换规则</p></li><li><p>对 <code>module</code> 进行转换后，再解析出当前 <code>module</code> 依赖的 <code>module</code></p></li><li><p>这些模块会以 <code>entry</code> 为单位分组，一个 <code>entry</code> 和其所有依赖的 <code>module</code> 被分到一个 <code>Chunk</code> 中</p></li><li><p>最后 <code>webpack</code> 会把所有 <code>Chunk</code> 转换成文件输出</p></li><li><p>在整个流程中 <code>webpack</code> 会在恰当的时机执行 <code>plugin</code> 里定义的逻辑</p></li></ul><h3 id="四、开发环境性能优化"><a href="#四、开发环境性能优化" class="headerlink" title="四、开发环境性能优化"></a>四、开发环境性能优化</h3><ul><li>优化打包构建速度<ul><li><code>HMR</code></li></ul></li><li>优化代码调试<ul><li><code>source-map</code></li></ul></li></ul><h4 id="1、HMR"><a href="#1、HMR" class="headerlink" title="1、HMR"></a>1、HMR</h4><p><code>HMR</code>（<code>hot module replacement</code>，热模块替换 / 模块热替换）的作用是：当一个模块发生变化，只会重新打包这一个模块，而不是打包所有模块，极大提升构建速度。</p><ul><li>对于样式文件，我们不用手动再启动 <code>HMR</code> 功能，因为 <code>style-loader</code> 内部已经实现了；</li><li>对于 <code>JavaScript</code> 文件，默认是不能使用 <code>HMR</code> 功能的，需要修改 <code>JavaScript</code> 代码，添加支持 <code>HMR</code> 功能的代码；注意：<code>HMR</code> 功能对 <code>JavaScript</code> 的处理，只能处理非入口 <code>JavaScript</code> 文件的其他文件。</li></ul><blockquote><p>例子：<a href="https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/HMR" target="_blank" rel="noopener">https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/HMR</a></p></blockquote><h4 id="2、source-map"><a href="#2、source-map" class="headerlink" title="2、source-map"></a>2、source-map</h4><p><code>source-map</code> 是一种 提供源代码到构建后代码映射技术，如果构建后代码出错了，通过映射可以追踪源代码错误。</p><p><strong>内联和外部的区别：</strong></p><ul><li>外部生成了文件，内联没有</li><li>内联构建速度更快</li></ul><p><strong>用法区别：</strong></p><ul><li><p><code>source-map</code>：外部，可以显示错误代码准确信息和源代码的错误位置；</p></li><li><p><code>inline-source-map</code>：内联，只生成一个内联 <code>source-map</code>，可以显示错误代码准确信息和源代码的错误位置；</p></li><li><p><code>hidden-source-map</code>：外部，显示错误代码错误原因，但是没有错误位置，不能追踪源代码错误，只能提示到构建后代码的错误位置；</p></li><li><code>eval-source-map</code>：内联，每一个文件都生成对应的 <code>source-map</code>，都在 <code>eval</code>，错误代码准确信息 和 源代码的错误位置，只是多了一个 <code>hash</code> 值；</li><li><code>nosources-source-map</code>：外部，显示错误代码准确信息，但是没有任何源代码信息；</li><li><code>cheap-source-map</code>：外部，显示错误代码准确信息和源代码的错误位置，只能精确到行；</li><li><code>cheap-module-source-map</code>：外部，错误代码准确信息 和 源代码的错误位置，<code>module</code> 会将 <code>loader</code> 的 <code>source map</code> 加入。</li></ul><p><strong>如何选择</strong></p><ul><li><p>开发环境：速度快（<code>eval&gt;inline&gt;cheap&gt;...</code>），调试更友好（可以显示源代码信息）</p><ul><li>速度快：<code>eval-cheap-source-map</code>、<code>eval-source-map</code></li><li>调试更友好：<code>source-map</code>、<code>cheap-module-source-map</code>、<code>cheap-source-map</code></li><li>平衡点：<code>eval-source-map</code> / <code>eval-cheap-module-source-map</code></li></ul></li><li><p>生产环境：隐藏源代码？调试要不要更友好？</p><ul><li>内联会让代码体积变大，所以在生产环境不用内联</li><li><code>nosources-source-map</code> 全部隐藏</li><li><code>hidden-source-map</code> 只隐藏源代码，会提示构建后代码错误信息</li><li>也需要平衡：<code>source-map</code> / <code>cheap-module-source-map</code></li></ul></li></ul><blockquote><p>例子：<a href="https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/source-map" target="_blank" rel="noopener">https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/source-map</a></p></blockquote><h3 id="五、生产环境性能优化"><a href="#五、生产环境性能优化" class="headerlink" title="五、生产环境性能优化"></a>五、生产环境性能优化</h3><ul><li>优化打包构建速度<ul><li><code>oneOf</code></li><li><code>babel</code> 缓存</li><li>多进程打包</li><li><code>externals</code></li><li><code>dll</code></li></ul></li><li>优化代码运行的性能<ul><li>缓存（<code>hash-chunkhash-contenthash</code>）</li><li><code>tree shaking</code></li><li><code>code splitting</code></li><li>懒加载/预加载</li><li><code>pwa</code> 渐进式网络开发应用程序（离线可访问）</li></ul></li></ul><h4 id="1、oneOf"><a href="#1、oneOf" class="headerlink" title="1、oneOf"></a>1、oneOf</h4><p>每个不同类型的文件在 <code>loader</code> 转换时，都会被命中，遍历 <code>module</code> 中 <code>rules</code> 中所有 <code>loader</code>，这也会影响性能。使用 <code>oneOf</code> 之后，当规则匹配时，只使用第一个匹配规则。</p><pre class="language-javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">//...</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
        oneOf<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            resourceQuery<span class="token punctuation">:</span> <span class="token regex">/inline/</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// foo.css?inline</span>
            use<span class="token punctuation">:</span> <span class="token string">'url-loader'</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            resourceQuery<span class="token punctuation">:</span> <span class="token regex">/external/</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// foo.css?external</span>
            use<span class="token punctuation">:</span> <span class="token string">'file-loader'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><p><strong>注意：</strong></p><ul><li>使用 <code>oneOf</code> 根据文件类型加载对应的 <code>loader</code> 时，只要能匹配一个即可退出；</li><li>对于同一类型文件，比如处理 <code>js</code>，如果需要多个 <code>loader</code>，可以单独抽离 <code>js</code> 处理，确保 <code>oneOf</code> 里面一个文件类型对应一个 <code>loader</code> ；</li><li>可以配置 <code>enforce: &#39;pre&#39;,</code> 指定优先执行。</li></ul><blockquote><p>例子：<a href="https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/oneOf" target="_blank" rel="noopener">https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/oneOf</a></p></blockquote><h4 id="2、缓存"><a href="#2、缓存" class="headerlink" title="2、缓存"></a>2、缓存</h4><h5 id="babel-缓存"><a href="#babel-缓存" class="headerlink" title="babel 缓存"></a>babel 缓存</h5><p>因为在生产环境中不能使用 <code>HMR</code>，要想也达到 <code>HMR</code> 的效果，在更改一个模块之后，不至于让别的模块也重新打包，可以使用 <code>babel</code> 缓存。</p><pre class="language-javascript"><code class="language-javascript"> use<span class="token punctuation">:</span> <span class="token punctuation">{</span>
   loader<span class="token punctuation">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
   options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
     cacheDirectory<span class="token punctuation">:</span> <span class="token boolean">true</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre><p>这样在第二次构建的时候，会读取之前的缓存，加快打包速度。</p><h5 id="文件资源缓存"><a href="#文件资源缓存" class="headerlink" title="文件资源缓存"></a>文件资源缓存</h5><blockquote><p>一般情况下，对于前端静态资源，浏览器访问的时候希望资源都能够进行缓存，当第二次及以后进入页面的时候，页面就可以直接使用缓存资源，这样的话，页面打开速度很快，提高了用户体验同时也节省了带宽资源。而其中最为常见的一种最大化利用缓存的形式就是为静态资源加上 <code>hash</code>，使用一个不会重复的标识符来达到资源可以永久缓存的目的。</p></blockquote><p>在 <code>Webpack</code> 打包的时候，我们可以给打包的文件名加上一个 <code>hash</code> 值，有两种方式：</p><ul><li><p><code>hash</code>：每次 <code>wepack</code> 构建时会生成一个唯一的 <code>hash</code> 值</p><ul><li>问题：因为 <code>js</code> 和 <code>css</code> 同时使用一个 <code>hash</code> 值；如果重新打包，会导致所有缓存失效（可能我却只改动一个文件）</li></ul></li><li><p><code>chunkhash</code>：根据 <code>chunk</code> 生成的 <code>hash</code> 值。如果打包来源于同一个 <code>chunk</code>，那么 <code>hash</code> 值就一样</p><ul><li>如何 <code>css</code> 是在 <code>js</code> 中被引入的，所以同属于一个 <code>chunk</code>，<code>js</code> 和 <code>css</code> 的 <code>hash</code> 值还是一样的。</li></ul></li><li><p><code>contenthash</code>：根据文件的内容生成 <code>hash</code> 值。不同文件 <code>hash</code> 值一定不一样，这会让代码上线运行缓存更好使用（上线代码性能优化）。</p></li></ul><blockquote><p>例子：<a href="https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/cache" target="_blank" rel="noopener">https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/cache</a></p></blockquote><h4 id="3、多进程打包"><a href="#3、多进程打包" class="headerlink" title="3、多进程打包"></a>3、多进程打包</h4><p><code>thread-loader</code> 一般是给 <code>loader</code> 用的。下面是一个在 <code>babel-loader</code> 中使用多进程打包的例子：</p><pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
    exclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
      use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          loader<span class="token punctuation">:</span> <span class="token string">'thread-loader'</span><span class="token punctuation">,</span>
          options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            workers<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token comment" spellcheck="true">// 进程2个</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          loader<span class="token punctuation">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
          options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// 预设：指示babel做怎么样的兼容性处理</span>
            presets<span class="token punctuation">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">[</span>
                <span class="token string">'@babel/preset-env'</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span>
                  <span class="token comment" spellcheck="true">// 按需加载</span>
                  useBuiltIns<span class="token punctuation">:</span> <span class="token string">'usage'</span><span class="token punctuation">,</span>
                  <span class="token comment" spellcheck="true">// 指定core-js版本</span>
                  corejs<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    version<span class="token punctuation">:</span> <span class="token number">3</span>
                  <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  <span class="token comment" spellcheck="true">// 指定兼容性做到哪个版本浏览器</span>
                  targets<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    chrome<span class="token punctuation">:</span> <span class="token string">'60'</span><span class="token punctuation">,</span>
                    firefox<span class="token punctuation">:</span> <span class="token string">'60'</span><span class="token punctuation">,</span>
                    ie<span class="token punctuation">:</span> <span class="token string">'9'</span><span class="token punctuation">,</span>
                    safari<span class="token punctuation">:</span> <span class="token string">'10'</span><span class="token punctuation">,</span>
                    edge<span class="token punctuation">:</span> <span class="token string">'17'</span>
                  <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">]</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token comment" spellcheck="true">// 开启babel缓存</span>
            <span class="token comment" spellcheck="true">// 第二次构建时，会读取之前的缓存</span>
            cacheDirectory<span class="token punctuation">:</span> <span class="token boolean">true</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><p>但是要注意，启动进程是需要时间的，进程间的通信也是需要时间的，如果本来构建时间就很快，这种情况下，不需要使用 <code>thread-loader</code> 。</p><blockquote><p>例子：<a href="https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/thread-loader" target="_blank" rel="noopener">https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/thread-loader</a></p></blockquote><h4 id="4、externals"><a href="#4、externals" class="headerlink" title="4、externals"></a>4、externals</h4><p><code>externals</code> 的作用是防止将某一些包打包到我们的输出中。假设我们的项目中使用了 <code>JQuery</code>，我们不希望将它打包到输出文件中，而是使用外部的 <code>CDN</code> 链接。</p><pre class="language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// 忽略打包的文件</span>
externals<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// 拒绝jQuery被打包进来</span>
  <span class="token comment" spellcheck="true">// 忽略库名 -- npm 包名</span>
  jquery<span class="token punctuation">:</span> <span class="token string">'jQuery'</span>
<span class="token punctuation">}</span>
</code></pre><p>注意，当我们忽略打包文件需要在 <code>HTML</code> 中使用 <code>script</code> 标签将其引入进来的。</p><blockquote><p>例子：<a href="https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/externals" target="_blank" rel="noopener">https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/externals</a></p></blockquote><h4 id="5、dll"><a href="#5、dll" class="headerlink" title="5、dll"></a>5、dll</h4><p>使用 <code>dll</code> 技术，可以对某些库（一般是第三方库：<code>jquery</code>、<code>react</code>、<code>vue</code>…）进行单独打包。</p><p><strong>基本过程</strong></p><ul><li><p>第一次的时候把请求的内容存储起来存储在映射表中；</p></li><li><p>再次请求时，先从映射表中找请求的内容，看是否有缓存，有则加载缓存（类似浏览器的缓存策略命中缓存），没有就正常打包。</p></li></ul><p><strong>缺点</strong>：配置很麻烦。</p><blockquote><p>例子：<a href="https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/dll" target="_blank" rel="noopener">https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/dll</a></p></blockquote><h4 id="5、tree-shaking"><a href="#5、tree-shaking" class="headerlink" title="5、tree shaking"></a>5、tree shaking</h4><p><code>tree shaking</code> 的作用是去除无用代码，让代码的体积更小。开启 <code>production</code> 环境后，默认就会启动 <code>tree shaking</code> 。</p><p>但是对于 <code>JavaScript</code> 文件来说，还有一个前提条件：必须使用 <code>ES6</code> 模块化。</p><p>最后还有一个问题需要注意，可能由于 <code>Webpack</code> 版本的原因，会把一些 <code>css</code> 资源给 <code>shaking</code> 掉，所以最好在 <code>package.json</code> 中配置一下：</p><pre class="language-javascript"><code class="language-javascript"><span class="token string">"sideEffects"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
  <span class="token string">"*.css"</span><span class="token punctuation">,</span>
  <span class="token string">"*.less"</span>
<span class="token punctuation">]</span>
</code></pre><blockquote><p>例子：<a href="https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/tree-shaking" target="_blank" rel="noopener">https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/tree-shaking</a></p></blockquote><h4 id="6、code-splitting"><a href="#6、code-splitting" class="headerlink" title="6、code splitting"></a>6、code splitting</h4><p>在最开始使用 <code>Webpack</code> 的时候，都是将所有的 <code>js</code> 文件全部打包到一个 <code>build.js</code> 文件中，但是在大型项目中，<code>build.js</code> 可能过大, 导致页面加载时间过长。这个时候就需要 <code>code splitting</code>。</p><p><code>code splitting</code> 就是将文件分割成块（<code>chunk</code>）, 我们可以定义一些分割点（<code>split point</code>），根据这些分割点对文件进行分块，并实现按需加载。</p><p>大致有三种方式来配置：</p><ul><li>添加多个入口 <code>entry</code><ul><li>缺点：不好维护，每次都需要新添加入口配置</li></ul></li><li>使用 <code>splitChunks</code> 配置<ul><li><strong><a href="https://webpack.docschina.org/plugins/split-chunks-plugin/" target="_blank" rel="noopener"><code>SplitChunksPlugin</code></a> 插件</strong>可以将 <code>node_modules</code> 或者其他公共的依赖模块中代码单独打包一个 <code>chunk</code> 最终输出</li><li>它也会自动分析多入口 <code>chunk</code> 中，有没有公共的文件，如果有则会打包成单独一个 <code>chunk</code></li></ul></li><li>通过 <code>js</code> 代码，让某个文件被单独打包成一个 <code>chunk</code><ul><li><code>import</code> 动态导入语法：能将某个文件单独打包</li></ul></li></ul><blockquote><p>例子：<a href="https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/code-splitting" target="_blank" rel="noopener">https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/code-splitting</a></p></blockquote><h4 id="7、懒加载和预加载"><a href="#7、懒加载和预加载" class="headerlink" title="7、懒加载和预加载"></a>7、懒加载和预加载</h4><ul><li><p>懒加载（延迟加载）：当文件需要使用时才加载。</p><pre class="language-javascript"><code class="language-javascript">document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment" spellcheck="true">/* webpackChunkName: 'test' */</span><span class="token string">'./test'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> mul <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">mul</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></li><li><p>预加载 <code>prefetch</code>：会在使用之前，提前加载 <code>js</code> 文件，等其他资源加载完毕，浏览器空闲了，再偷偷加载资源（兼容性比较差）。</p><pre class="language-javascript"><code class="language-javascript">document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment" spellcheck="true">/* webpackChunkName: 'test', webpackPrefetch: true */</span><span class="token string">'./test'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> mul <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">mul</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></li></ul><blockquote><p><a href="https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/lazy-loading" target="_blank" rel="noopener">https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/lazy-loading</a></p></blockquote><h4 id="8、PWA"><a href="#8、PWA" class="headerlink" title="8、PWA"></a>8、PWA</h4><p>渐进式网络开发应用程序（离线可访问），使用 <code>workbox-webpack-plugin</code> 插件来实现。有两个步骤：</p><p>1、在 <code>Webpack</code> 中配置：</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">WorkboxWebpackPlugin<span class="token punctuation">.</span>GenerateSW</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">/*
    作用：
      1. 帮助serviceworker快速启动
      2. 删除旧的 serviceworker，生成一个 serviceworker 配置文件
  */</span>
  clientsClaim<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  skipWaiting<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>2、注册 <code>serviceWorker</code>，并处理兼容性问题：</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'serviceWorker'</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'load'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    navigator<span class="token punctuation">.</span>serviceWorker
      <span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'/service-worker.js'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'sw注册成功了~'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'sw注册失败了~'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>另外，<code>serviceWorker</code> 必须在服务器上。</p><blockquote><p>例子：<a href="https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/pwa" target="_blank" rel="noopener">https://github.com/IDeepspace/webpack-performance-enhancement-example/tree/master/pwa</a></p></blockquote><h3 id="六、更多"><a href="#六、更多" class="headerlink" title="六、更多"></a>六、更多</h3><ul><li><a href="https://webpack.wuhaolin.cn/" target="_blank" rel="noopener">深入浅出 Webpack</a></li><li><a href="https://www.timsrc.com/article/2/webpack-book" target="_blank" rel="noopener">Webpack小书</a></li><li><a href="https://tsejx.github.io/webpack-guidebook/" target="_blank" rel="noopener">Webpack Guidebook</a></li><li><a href="https://webpack.docschina.org/concepts/" target="_blank" rel="noopener">Webpack 中文官网</a></li></ul></div><hr><style>#reward{margin:40px 0;text-align:center}#reward .reward-link{font-size:1.88rem}#reward .btn-floating:hover{box-shadow:0 6px 12px rgba(0,0,0,.2),0 5px 15px rgba(0,0,0,.2)}#rewardModal{width:320px;height:350px}#rewardModal .reward-title{margin:15px auto;padding-bottom:5px}#rewardModal .modal-content{padding:10px}#rewardModal .close{position:absolute;right:15px;top:15px;color:rgba(0,0,0,.5);font-size:1.3rem;line-height:20px;cursor:pointer}#rewardModal .reward-tabs{margin:0 auto;width:210px}.reward-tabs .tabs{height:38px;margin:10px auto;padding-left:0}.reward-tabs .tabs .tab{height:38px;line-height:38px}.reward-tabs .tab a{color:#fff;background-color:#ccc}.reward-tabs .tab a:hover{color:#fff}.reward-tabs .wechat-tab .active{color:#fff;background-color:#22ab38}.reward-tabs .alipay-tab .active{color:#fff;background-color:#019fe8}.reward-tabs .reward-img{width:210px;height:210px}</style><div id="reward"> <a class="reward-link btn-floating btn-large waves-effect waves-light red">赏</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close"><i class="fa fa-close"></i></a><h4 class="reward-title">请我喝杯咖啡?</h4><div class="reward-content"><div class="reward-tabs"><ul class="tabs"><li class="tab wechat-tab waves-effect waves-light"><a class="active" href="#wechat">微信</a></li><li class="tab alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li></ul><div id="wechat"> <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码"></div><div id="alipay"> <img src="/medias/reward/alipay.png" class="reward-img" alt="支付宝打赏二维码"></div></div></div></div></div></div><script>$(function(){$("#reward .reward-link").on("click",function(){$("#rewardModal").openModal()}),$("#rewardModal .close").on("click",function(){$("#rewardModal").closeModal()})})</script><link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div></div><script src="/libs/share/js/social-share.min.js"></script><div class="reprint"><p> <span class="reprint-tip">转载请注明:</span> <a href="https://togoblog.cn" class="b-link-green">Deepspace</a><i class="fa fa-angle-right fa-lg fa-fw text-color"></i> <a href="/webpack-performance-enhancement/" class="b-link-green">Webpack 性能优化</a></p></div></div></div><div class="article" data-aos="fade-up"><div class="card relate-article-wrapper"><header class="relate-article-header">相关文章&nbsp;<i class="fa fa-arrow-right"></i></header><div class="relate-post-box"><div class="relate-post"> <span>1、</span><a id="relate-post-link" href="/set-up-ci-env-with-circleci-and-github/">使用 CircleCI + Github 搭建持续集成环境</a></div><div class="relate-post"> <span>2、</span><a id="relate-post-link" href="/what-is-ci-cd/">Web 前端工程化（二） —— CI/CD</a></div><div class="relate-post"> <span>3、</span><a id="relate-post-link" href="/what-is-frontend-backend-separation/">Web 前端工程化（一） —— 什么是前后端分离？</a></div><div class="relate-post"> <span>4、</span><a id="relate-post-link" href="/mvc-map-mvvm/">谈谈前端开发中的 MVC、MVP、MVVM 模式</a></div><div class="relate-post"> <span>5、</span><a id="relate-post-link" href="/reflow-and-repaint/">浏览器的重排和重绘</a></div></div></div></div><div class="disqus-card card" data-aos="fade-up"><div id="disqus_thread" class="card-content"><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div><script type="text/javascript">
    disqus_config = function () {
        this.page.url = 'https://togoblog.cn/webpack-performance-enhancement/';
        this.page.identifier = '/webpack-performance-enhancement/';
        this.page.title = 'Webpack 性能优化';
    };
    let disqus_shortname = 'https-togoblog-cn';

    (function () { // DON'T EDIT BELOW THIS LINE
        let d = document, s = d.createElement('script');
        // 如：s.src = 'https://Deepspace.disqus.com/embed.js';
        s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script></div></div><div class="col l3 hide-on-med-and-down"><div class="toc-widget"><div class="toc-title">目录</div><div id="toc-content"></div></div></div></div><script src="/libs/tocbot/tocbot.min.js"></script><script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingSelector: 'h2, h3, h4, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });
    });
</script></main><footer class="page-footer bg-color"><div class="container row center-align"><div class="col s12 m8 l8 copy-right"> <span>COPYRIGHT 2020 DEEPSPACE. ALL RIGHTS RESERVED.</span></div><div class="col s12 m4 l4 social-link"><a href="https://github.com/IDeepspace" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fa fa-github"></i></a><a href="mailto:cxin1427@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fa fa-envelope-open"></i></a><a href="#!" class="tooltipped" data-tooltip="QQ: 690862036" data-position="top" data-delay="50"><i class="fa fa-qq"></i></a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fa fa-rss"></i></a></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"> <span class="title">搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input" autofocus></div><div id="searchResult"></div></div></div><script src="/js/search.js"></script><script type="text/javascript">searchFunc("/search.xml","searchInput","searchResult")</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fa fa-angle-up"></i></a></div><script src="/libs/materialize/js/materialize.min.js"></script><script src="/libs/masonry/masonry.pkgd.min.js"></script><script src="/libs/aos/aos.js"></script><script src="/libs/scrollprogress/scrollProgress.min.js"></script><script src="/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="/js/matery.js"></script></body></html>