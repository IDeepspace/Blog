<!DOCTYPE HTML><html lang="zh-CN"><head><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="keywords" content="MySQL 笔记, Deepspace"><meta name="description" content="一、安装网络上已经有很多讲述如何在 Windows、Mac、和 Ubuntu 等环境上安装 MySQL 的教程了，这里就不再赘述。
为了不在本地机器上设置太多的环境，这里我们使用 Docker 来安装 MySQL 并学习如何使用。
1、安装"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><title>MySQL 笔记 | Deepspace</title><link rel="icon" type="image/png" href="/favicon.png"><link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="/libs/materialize/css/materialize.min.css"><link rel="stylesheet" type="text/css" href="/libs/aos/aos.css"><link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css"><link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" type="text/css" href="/css/matery.css"><link rel="stylesheet" type="text/css" href="/css/my.css"><script src="/libs/jquery/jquery-2.2.0.min.js"></script><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head></head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="container"><div class="nav-wrapper"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><span></span> <span class="logo-span">Deepspace</span></a></div><a href="#" data-activates="mobile-nav" class="button-collapse"><i class="fa fa-navicon"></i></a><ul class="right"><li class="hide-on-med-and-down"><a href="/" class="waves-effect waves-light"><i class="fa fa-home"></i> <span>首页</span></a></li><li class="hide-on-med-and-down"><a href="/tags" class="waves-effect waves-light"><i class="fa fa-tags"></i> <span>标签</span></a></li><li class="hide-on-med-and-down"><a href="/categories" class="waves-effect waves-light"><i class="fa fa-bookmark"></i> <span>分类</span></a></li><li class="hide-on-med-and-down"><a href="/archives" class="waves-effect waves-light"><i class="fa fa-archive"></i> <span>归档</span></a></li><li class="hide-on-med-and-down"><a href="/about" class="waves-effect waves-light"><i class="fa fa-user-circle-o"></i> <span>关于</span></a></li><li><a id="toggleSearch" class="waves-effect waves-light"><i id="searchIcon" class="mdi-action-search"></i></a></li></ul><div class="side-nav" id="mobile-nav"><div class="mobile-head bg-color"><div class="logo-name">Deepspace</div><div class="logo-desc"> 凡事预 ？立 ：废</div></div><ul class="menu-list mobile-menu-list"><li><a href="/" class="waves-effect waves-light"><i class="fa fa-fw fa-home"></i> 首页</a></li><li><a href="/tags" class="waves-effect waves-light"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li><a href="/categories" class="waves-effect waves-light"><i class="fa fa-fw fa-bookmark"></i> 分类</a></li><li><a href="/archives" class="waves-effect waves-light"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li><a href="/about" class="waves-effect waves-light"><i class="fa fa-fw fa-user-circle-o"></i> 关于</a></li><li><div class="divider"></div></li><li><a href="https://github.com/IDeepspace" class="waves-effect waves-light" target="_blank"><i class="fa fa-github-square fa-fw"></i> Fork Me</a></li></ul><div class="social-link"><a href="https://github.com/IDeepspace" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fa fa-github"></i></a><a href="mailto:cxin1427@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fa fa-envelope-open"></i></a><a href="#!" class="tooltipped" data-tooltip="QQ: 690862036" data-position="top" data-delay="50"><i class="fa fa-qq"></i></a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fa fa-rss"></i></a></div></div></div></div><style>.nav-transparent .github-corner{display:none!important}.github-corner{position:absolute;z-index:10;top:0;right:0;border:0;transform:scale(1.1)}.github-corner svg{color:#202020;fill:#fff;height:64px;width:64px}.github-corner:hover .octo-arm{animation:a .56s ease-in-out}.github-corner .octo-arm{animation:none}@keyframes a{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}</style> <a href="https://github.com/IDeepspace" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50"><svg viewbox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a></nav></header><div class="bg-cover post-cover" style="background-image:url(/medias/featureimages/lighted.jpg)"><div class="container"><div class="row"><div class="col s12 m12 l12"><div class="brand"><div class="description center-align post-detail-title"> MySQL 笔记</div></div></div></div></div></div><main class="post-container content"><link rel="stylesheet" href="/libs/tocbot/tocbot.css"><style>#articleContent h1,#articleContent h2,#articleContent h3,#articleContent h4,#articleContent h5,#articleContent h6{padding-top:76px;margin-top:-76px}#articleContent h1{line-height:3.5rem}#articleContent h2{line-height:3.2rem}#articleContent h3{line-height:2.8rem}#articleContent h4{line-height:2.5rem}#articleContent h5{line-height:2.2rem}#articleContent h6{line-height:1.9rem}#articleContent :focus{outline:0}.toc-fixed{position:fixed;top:64px}.toc-widget{padding-left:20px}.toc-widget .toc-title{margin:35px 0 15px 0;padding-left:17px;font-size:1.5rem;font-weight:700;line-height:1.5rem}.toc-widget ol{padding:0;list-style:none}#toc-content ol{padding-left:10px}#toc-content ol li{padding-left:10px}#toc-content .toc-link:hover{color:#42b983;font-weight:700;text-decoration:underline}#toc-content .toc-link::before{background-color:transparent;max-height:25px}#toc-content .is-active-link{color:#42b983}#toc-content .is-active-link::before{background-color:#42b983}</style><div class="row"><div class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="article-tag"> <a href="/tags/Docker/" target="_blank"><span class="chip bg-color">Docker</span></a> <a href="/tags/Mysql/" target="_blank"><span class="chip bg-color">Mysql</span></a></div><div class="post-info"><span class="post-cate"><i class="fa fa-bookmark fa-fw icon-category"></i> <a href="/categories/DataBase/" class="post-category" target="_blank">DataBase</a></span><span class="post-date"><i class="fa fa-clock-o fa-fw"></i> 2016-03-29</span></div></div><hr><div class="card-content article-card-content"><div id="articleContent"><h3 id="一、安装"><a href="#一、安装" class="headerlink" title="一、安装"></a>一、安装</h3><p>网络上已经有很多讲述如何在 <code>Windows</code>、<code>Mac</code>、和 <code>Ubuntu</code> 等环境上安装 <code>MySQL</code> 的教程了，这里就不再赘述。</p><p>为了不在本地机器上设置太多的环境，这里我们使用 <code>Docker</code> 来安装 <code>MySQL</code> 并学习如何使用。</p><h4 id="1、安装-Docker"><a href="#1、安装-Docker" class="headerlink" title="1、安装 Docker"></a>1、安装 Docker</h4><p><code>Mac</code> 客户端下：</p><pre class="language-bash"><code class="language-bash">$ brew cask <span class="token function">install</span> docker
</code></pre><p>也可以手动下载 <code>.dmg</code> 格式安装包进行安装。</p><p>其它环境安装 <code>Docker</code> 的方式可以参考官方文档：<a href="https://docs.docker.com/get-docker/" target="_blank" rel="noopener">https://docs.docker.com/get-docker/</a></p><p>验证安装：</p><pre class="language-bash"><code class="language-bash">$ docker --version
</code></pre><p>输出所安装的 <code>Docker</code> 版本。</p><h4 id="2、拉取-MySQL-镜像"><a href="#2、拉取-MySQL-镜像" class="headerlink" title="2、拉取 MySQL 镜像"></a>2、拉取 MySQL 镜像</h4><p>这里我们拉取最新版本的镜像：</p><pre class="language-bash"><code class="language-bash">$ docker pull mysql
</code></pre><h4 id="3、启动-MySQL-容器"><a href="#3、启动-MySQL-容器" class="headerlink" title="3、启动 MySQL 容器"></a>3、启动 MySQL 容器</h4><pre class="language-bash"><code class="language-bash">$ docker run -d -p 127.0.0.1:3306:3306 --name test_mysql -e MYSQL_ROOT_PASSWORD<span class="token operator">=</span>123456 mysql:latest
</code></pre><p>这里没有将容器中的数据映射出来；如果需要，可以在本机创建一个用作数据持久化的目录，将容器中的数据映射到本机该目录中：</p><pre class="language-bash"><code class="language-bash">$ docker run -d -p 127.0.0.1:3306:3306 --name mysql -v /Users/cxin/Development/persistent-local-data-for-mysql:/var/lib/mysql -e MYSQL_ROOT_PASSWORD<span class="token operator">=</span><span class="token string">"123456"</span> mysql:latest
</code></pre><p>验证启动：</p><pre class="language-bash"><code class="language-bash">$ docker <span class="token function">ps</span>
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                                 NAMES
f0da3247bdd4        mysql:latest        <span class="token string">"docker-entrypoint.s…"</span>   56 seconds ago      Up 54 seconds       127.0.0.1:3306-<span class="token operator">></span>3306/tcp, 33060/tcp   test_mysql
</code></pre><p>我们可以进入 <code>test_mysql</code> 容器：</p><pre class="language-bash"><code class="language-bash">$ docker <span class="token function">exec</span> -it test_mysql <span class="token function">bash</span>
$ root@f0da3247bdd4:/<span class="token comment" spellcheck="true">#</span>
</code></pre><p>在容器内登陆 <code>Mysql</code>：</p><pre class="language-bash"><code class="language-bash">$ root@f0da3247bdd4:/<span class="token comment" spellcheck="true"># mysql -uroot -p123456</span>
mysql<span class="token operator">></span>
</code></pre><p>登录后会显示 <code>mysql</code> 命令。</p><p>显示所有数据库：</p><pre class="language-bash"><code class="language-bash">mysql<span class="token operator">></span> show databases<span class="token punctuation">;</span>
+--------------------+
<span class="token operator">|</span> Database           <span class="token operator">|</span>
+--------------------+
<span class="token operator">|</span> information_schema <span class="token operator">|</span>
<span class="token operator">|</span> mysql              <span class="token operator">|</span>
<span class="token operator">|</span> performance_schema <span class="token operator">|</span>
<span class="token operator">|</span> sys                <span class="token operator">|</span>
+--------------------+
4 rows <span class="token keyword">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>
</code></pre><p>退出登录：</p><pre class="language-bash"><code class="language-bash">mysql<span class="token operator">></span> <span class="token keyword">exit</span><span class="token punctuation">;</span>
</code></pre><h4 id="4、通过客户端来连接"><a href="#4、通过客户端来连接" class="headerlink" title="4、通过客户端来连接"></a>4、通过客户端来连接</h4><p>由于前面我们已经把数据库容器的端口映射出来了，所以我们也可以通过一些「数据库可视化客户端」或者「程序代码」进行数据库连接：</p><pre><code>Host: 127.0.0.1
Port: 3306
User: root
Password: 123456
</code></pre><p>这里推荐一些可视化数据库工具：</p><ul><li><code>DataGrip</code>：<code>Jetbrain</code> 家的产品，收费；</li><li><code>DBeaver</code>：功能强大，免费；</li><li><code>Navicat</code>：收费。</li></ul><h3 id="二、导入演示数据"><a href="#二、导入演示数据" class="headerlink" title="二、导入演示数据"></a>二、导入演示数据</h3><p>为了便于演示，这里需要先导入一份数据库数据：</p><blockquote><p>链接:<a href="https://pan.baidu.com/s/1brD2UJKWgpO0GKicFkyyiA" target="_blank" rel="noopener">https://pan.baidu.com/s/1brD2UJKWgpO0GKicFkyyiA</a> 密码:4nqz</p></blockquote><p>如何导入？</p><p>假设下载解压后的文件在本机的存储地址为：<code>/Users/cxin/Downloads/mysqlsampledatabase.sql</code>。</p><p>首先需要将宿主机（本机）上的文件拷贝至容器中，执行命令：</p><pre class="language-bash"><code class="language-bash">$ docker <span class="token function">cp</span> /Users/cxin/Downloads/mysqlsampledatabase.sql f0da3247bdd4:/opt/
</code></pre><p>进入容器，在容器内登陆 <code>Mysql</code> 并执行数据库脚本文件：</p><pre class="language-bash"><code class="language-bash">$ docker <span class="token function">exec</span> -it test_mysql <span class="token function">bash</span>
$ root@f0da3247bdd4:/opt<span class="token comment" spellcheck="true"># mysql -uroot -p123456</span>
mysql<span class="token operator">></span> <span class="token function">source</span> /opt/mysqlsampledatabase.sql
</code></pre><p>该脚本会创建一个名为 <code>classicmodels</code> 的数据库，并写入一些数据。</p><pre class="language-bash"><code class="language-bash">mysql<span class="token operator">></span> show databases<span class="token punctuation">;</span>
+--------------------+
<span class="token operator">|</span> Database           <span class="token operator">|</span>
+--------------------+
<span class="token operator">|</span> classicmodels      <span class="token operator">|</span>
<span class="token operator">|</span> information_schema <span class="token operator">|</span>
<span class="token operator">|</span> mysql              <span class="token operator">|</span>
<span class="token operator">|</span> performance_schema <span class="token operator">|</span>
<span class="token operator">|</span> sys                <span class="token operator">|</span>
+--------------------+
5 rows <span class="token keyword">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>
</code></pre><p>数据库的表之间的关系为：</p><p><img src="https://github.com/IDeepspace/ImageHosting/raw/master/DB/MySQL-Sample-Database-Schema.png" alt="MySQL-Sample-Database-Schema"></p><p>接下来的 <code>SQL</code> 语句讲解都是基于上面所导入的数据。</p><h3 id="二、查询"><a href="#二、查询" class="headerlink" title="二、查询"></a>二、查询</h3><h4 id="1、SELECT"><a href="#1、SELECT" class="headerlink" title="1、SELECT"></a>1、SELECT</h4><p>语法：</p><pre class="language-mysql"><code class="language-mysql">SELECT select_list
FROM table_name;
</code></pre><p>例子：</p><p>查询一张表中的所有数据：</p><pre class="language-mysql"><code class="language-mysql">SELECT * FROM employees;
</code></pre><p>查询一条数据：</p><pre class="language-mysql"><code class="language-mysql">SELECT lastName
FROM employees;
</code></pre><p>查询多条数据</p><pre class="language-mysql"><code class="language-mysql">SELECT
    lastname,
    firstname,
    jobtitle
FROM
    employees;
</code></pre><h3 id="三、排序"><a href="#三、排序" class="headerlink" title="三、排序"></a>三、排序</h3><h4 id="1、ORDER-BY"><a href="#1、ORDER-BY" class="headerlink" title="1、ORDER BY"></a>1、ORDER BY</h4><p>语法：</p><pre class="language-mysql"><code class="language-mysql">SELECT
   select_list
FROM
   table_name
ORDER BY
   column1 [ASC|DESC],
   column2 [ASC|DESC],
   ...;
</code></pre><p>例子：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    contactLastname,
    contactFirstname
FROM
    customers
ORDER BY
    contactLastname DESC,
    contactFirstname ASC;
</code></pre><p>也可以写表达式：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    orderNumber,
    orderlinenumber,
    quantityOrdered,
    priceEach,
    quantityOrdered * priceEach as subtotal
FROM
    orderdetails
ORDER BY
   quantityOrdered * priceEach DESC;
</code></pre><h4 id="2、FIELD"><a href="#2、FIELD" class="headerlink" title="2、FIELD"></a>2、FIELD</h4><p>分类排序：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    orderNumber,
    status
FROM
    orders
ORDER BY
    FIELD(status,
        'In Process',
        'On Hold',
        'Cancelled',
        'Resolved',
        'Disputed',
        'Shipped');
</code></pre><h3 id="四、过滤"><a href="#四、过滤" class="headerlink" title="四、过滤"></a>四、过滤</h3><h4 id="1、WHERE"><a href="#1、WHERE" class="headerlink" title="1、WHERE"></a>1、WHERE</h4><p>语法：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    select_list
FROM
    table_name
WHERE
    search_condition;
</code></pre><p>例子：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    lastname,
    firstname,
    jobtitle
FROM
    employees
WHERE
    jobtitle = 'Sales Rep';
</code></pre><p>使用 <code>AND</code>：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    lastname,
    firstname,
    jobtitle,
    officeCode
FROM
    employees
WHERE
    jobtitle = 'Sales Rep' AND
    officeCode = 1;
</code></pre><p>使用 <code>OR</code>：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    lastName,
    firstName,
    jobTitle,
    officeCode
FROM
    employees
WHERE
    jobtitle = 'Sales Rep' OR
    officeCode = 1
ORDER BY
    officeCode ,
    jobTitle;
</code></pre><p>使用 <code>BETWEEN</code> ：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    firstName,
    lastName,
    officeCode
FROM
    employees
WHERE
    officeCode BETWEEN 1 AND 3
ORDER BY officeCode;
</code></pre><p>使用 <code>LIKE</code> ：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    firstName,
    lastName
FROM
    employees
WHERE
    lastName LIKE '%son'
ORDER BY firstName;
</code></pre><p>使用 <code>IN</code> ：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    firstName,
    lastName,
    officeCode
FROM
    employees
WHERE
    officeCode IN (1 , 2, 3)
ORDER BY
    officeCode;
</code></pre><p>使用 <code>IS NULL</code> ：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    lastName,
    firstName,
    reportsTo
FROM
    employees
WHERE
    reportsTo IS NULL;
</code></pre><p>过滤时也可以使用数学比较符：</p><table><thead><tr><th style="text-align:left">Operator</th><th style="text-align:left">Description</th></tr></thead><tbody><tr><td style="text-align:left">=</td><td style="text-align:left">Equal to. You can use it with almost any data types.</td></tr><tr><td style="text-align:left">&lt;&gt; or !=</td><td style="text-align:left">Not equal to</td></tr><tr><td style="text-align:left">&lt;</td><td style="text-align:left">Less than. You typically use it with numeric and date/time data types.</td></tr><tr><td style="text-align:left">&gt;</td><td style="text-align:left">Greater than.</td></tr><tr><td style="text-align:left">&lt;=</td><td style="text-align:left">Less than or equal to</td></tr><tr><td style="text-align:left">&gt;=</td><td style="text-align:left">Greater than or equal to</td></tr></tbody></table><p>如：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    lastname,
    firstname,
    officeCode
FROM
    employees
WHERE
    officecode > 5;
</code></pre><p>不等于我们也可以这样写：</p><pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span>
    lastname<span class="token punctuation">,</span>
    firstname<span class="token punctuation">,</span>
    jobtitle
<span class="token keyword">FROM</span>
    employees
<span class="token keyword">WHERE</span>
    jobtitle <span class="token operator">&lt;></span> <span class="token string">'Sales Rep'</span><span class="token punctuation">;</span>
</code></pre><h4 id="2、DISTINCT"><a href="#2、DISTINCT" class="headerlink" title="2、DISTINCT"></a>2、DISTINCT</h4><p><code>DISTINCT</code> 可以用来去除重复元素。</p><p>语法：</p><pre class="language-mysql"><code class="language-mysql">SELECT DISTINCT
    select_list
FROM
    table_name;
</code></pre><p>例子：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    DISTINCT lastname
FROM
    employees
ORDER BY
    lastname;
</code></pre><blockquote><p>注意：如果有多条数据的值为 <code>NULL</code> 值，MySQL 也只会查出来一条。</p></blockquote><p>在多个 <code>COLUMN</code> 中去重：</p><pre class="language-mysql"><code class="language-mysql">SELECT DISTINCT
    state, city
FROM
    customers
WHERE
    state IS NOT NULL
ORDER BY
    state,
    city;
</code></pre><p>这个时候，<code>Mysql</code> 会使用这些列中的值的组合来确定唯一性。</p><p>在 <code>DISTINCT</code> 中使用表达式：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    COUNT(DISTINCT state)
FROM
    customers
WHERE
    country = 'USA';
</code></pre><p><code>DISTINCT</code> 和 <code>LIMIT</code> 结合使用：</p><pre class="language-mysql"><code class="language-mysql">SELECT DISTINCT
    state
FROM
    customers
WHERE
    state IS NOT NULL
LIMIT 5;
</code></pre><p><code>LIMIT</code> 可用于限制查询的数量。</p><h4 id="3、GROUP-BY"><a href="#3、GROUP-BY" class="headerlink" title="3、GROUP BY"></a>3、GROUP BY</h4><p><code>GROUP BY</code> 的效果和 <code>DISTINCT</code> 类似，也可以去重。当然 <code>GROUP BY</code> 还可以支持更多的表达式。</p><pre class="language-mysql"><code class="language-mysql">SELECT
    state
FROM
    customers
GROUP BY state;
</code></pre><p><code>GROUP BY</code> 的作用是按照指定的规则对数据进行分组，下面会讲到。</p><h3 id="五、联表查询"><a href="#五、联表查询" class="headerlink" title="五、联表查询"></a>五、联表查询</h3><h4 id="1、设置别名"><a href="#1、设置别名" class="headerlink" title="1、设置别名"></a>1、设置别名</h4><p>我们可以为 <code>Table</code> 或者 <code>Column</code> 以及一些表达式的结果设置别名（<code>alias</code>）。</p><p>语法：</p><pre class="language-mysql"><code class="language-mysql">SELECT
   [column_1 | expression] AS descriptive_name
FROM table_name;
</code></pre><p>如果别名中包含空格，就需要这样写：</p><pre class="language-mysql"><code class="language-mysql">SELECT
   [column_1 | expression] AS `descriptive name`
FROM
   table_name;
</code></pre><p>用指定的字符连接字符串 <code>CONCAT_WS</code>，看个综合的例子：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    CONCAT_WS(', ', lastName, firstname) `Full name`
FROM
    employees
ORDER BY
    `Full name`;
</code></pre><p>配合 <code>HAVING</code> 使用：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    orderNumber `Order no.`,
    SUM(priceEach * quantityOrdered) total
FROM
    orderdetails
GROUP BY
    `Order no.`
HAVING
    total > 60000;
</code></pre><h4 id="2、JOIN"><a href="#2、JOIN" class="headerlink" title="2、JOIN"></a>2、JOIN</h4><p>下面我们来看一下如何在两张或者两张以上的表中查询数据。</p><p>一个关系数据库由多个相关的表组成，表之间使用公共的列连接在一起，这些列被称为外键。</p><p>以我们导入的数据库为例， <code>orders</code> 和 <code>orderdetails</code> 这两张表就使用 <code>orderNumber</code> 这个外键进行连接。如果要获得完整的订单信息就需要联表查询，这就是 <code>JOIN</code> 的作用。</p><p>语法：</p><pre class="language-mysql"><code class="language-mysql">SELECT column_list
FROM table_1
INNER JOIN table_2 ON join_condition;
</code></pre><p>例子：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    o.orderNumber,
    o.orderDate,
    o.orderNumber,
    o.status,
    od.priceEach,
    od.quantityOrdered,
    od.productCode
FROM orders o
INNER JOIN orderdetails od on o.orderNumber = od.orderNumber;
</code></pre><p>上面的语句等同于：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    o.orderNumber,
    o.orderDate,
    o.orderNumber,
    o.status,
    od.priceEach,
    od.quantityOrdered,
    od.productCode
FROM orders o, orderdetails od
WHERE o.orderNumber = od.orderNumber;
</code></pre><p>当然，这里也可以省略 <code>INNER</code> 使用 <code>JOIN</code>，效果是一样的。</p><h4 id="3、LEFT-JOIN"><a href="#3、LEFT-JOIN" class="headerlink" title="3、LEFT JOIN"></a>3、LEFT JOIN</h4><p><code>LEFT JOIN</code> 与 <code>JOIN</code> 有所不同。<code>LEFT JOIN</code> 以左表为基准，会读取左表的全部数据，如果右表无对应数据则显示 <code>Null</code>。</p><pre class="language-mysql"><code class="language-mysql">SELECT
    c.customerNumber,
    customerName,
    orderNumber,
    status
FROM
    customers c
LEFT JOIN orders o
    ON c.customerNumber = o.customerNumber;
</code></pre><h4 id="4、RIGHT-JOIN"><a href="#4、RIGHT-JOIN" class="headerlink" title="4、RIGHT JOIN"></a>4、RIGHT JOIN</h4><p>和左连接刚好相反，以右表为基准，会读取右表的全部数据，如果左表无对应数据则显示 <code>Null</code>。</p><pre class="language-mysql"><code class="language-mysql">SELECT
    c.customerNumber,
    customerName,
    orderNumber,
    status
FROM
    customers c
LEFT JOIN orders o
    ON c.customerNumber = o.customerNumber;
</code></pre><h4 id="5、CROSS-JOIN"><a href="#5、CROSS-JOIN" class="headerlink" title="5、CROSS JOIN"></a>5、CROSS JOIN</h4><p><code>CROSS JOIN</code> （交叉连接）：交叉联接返回左表中的所有行，左表中的每一行与右表中的所有行组合。</p><pre class="language-mysql"><code class="language-mysql">SELECT
    employeeNumber,
    customerNumber
FROM
    customers
CROSS JOIN employees
    ON salesRepEmployeeNumber = employeeNumber
LIMIT 20;
</code></pre><h3 id="六、分组"><a href="#六、分组" class="headerlink" title="六、分组"></a>六、分组</h3><h4 id="1、GROUP-BY"><a href="#1、GROUP-BY" class="headerlink" title="1、GROUP BY"></a>1、GROUP BY</h4><p>语法：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    c1, c2,..., cn, aggregate_function(ci)
FROM
    table
WHERE
    where_conditions
GROUP BY c1 , c2,...,cn;
</code></pre><p>例子：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    status,
    COUNT(*)
FROM
    orders
GROUP BY
    status
ORDER BY
    status DESC;
</code></pre><h4 id="2、HAVING"><a href="#2、HAVING" class="headerlink" title="2、HAVING"></a>2、HAVING</h4><p><code>HAVING</code> 的作用是筛选满足条件的组，即在分组之后过滤数据，条件中经常包含聚组函数。</p><blockquote><p>在 <code>SQL</code> 中增加 <code>HAVING</code> 原因是，<code>WHERE</code> 关键字无法与合计函数一起使用。</p></blockquote><p>语法：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    select_list
FROM
    table_name
WHERE
    search_condition
GROUP BY
    group_by_expression
HAVING
    group_condition;
</code></pre><p>例子：</p><pre class="language-mysql"><code class="language-mysql">SELECT
    a.ordernumber,
    status,
    SUM(priceeach*quantityOrdered) total
FROM
    orderdetails a
INNER JOIN orders b
    ON b.ordernumber = a.ordernumber
GROUP BY
    ordernumber,
    status
HAVING
    status = 'Shipped' AND
    total > 1500
ORDER BY
    total
LIMIT 10;
</code></pre><h3 id="七、修改数据"><a href="#七、修改数据" class="headerlink" title="七、修改数据"></a>七、修改数据</h3><h4 id="1、INSERT"><a href="#1、INSERT" class="headerlink" title="1、INSERT"></a>1、INSERT</h4><p>用作插入数据。</p><p>语法：</p><pre class="language-mysql"><code class="language-mysql">INSERT INTO table(c1,c2,...)
VALUES
   (v11,v12,...),
   (v21,v22,...),
    ...
   (vnn,vn2,...);
</code></pre><p>例子：</p><pre class="language-mysql"><code class="language-mysql">CREATE TABLE projects(
    project_id INT AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    start_date DATE,
    end_date DATE,
    PRIMARY KEY(project_id)
);

INSERT INTO
    projects(name, start_date, end_date)
VALUES
    ('AI for Marketing','2019-08-01','2019-12-31'),
    ('ML for Sales','2019-05-15','2019-11-20');
</code></pre><p>使用 <code>SELECT</code> 语句的结果作为 <code>INSERT</code> 语句的数据源：</p><pre class="language-mysql"><code class="language-mysql">CREATE TABLE suppliers (
    supplierNumber INT AUTO_INCREMENT,
    supplierName VARCHAR(50) NOT NULL,
    phone VARCHAR(50),
    addressLine1 VARCHAR(50),
    addressLine2 VARCHAR(50),
    city VARCHAR(50),
    state VARCHAR(50),
    postalCode VARCHAR(50),
    country VARCHAR(50),
    customerNumber INT,
    PRIMARY KEY (supplierNumber)
);

INSERT INTO suppliers (
    supplierName,
    phone,
    addressLine1,
    addressLine2,
    city,
    state,
    postalCode,
    country,
    customerNumber
)
SELECT
    customerName,
    phone,
    addressLine1,
    addressLine2,
    city,
    state ,
    postalCode,
    country,
    customerNumber
FROM
    customers
WHERE
    country = 'USA' AND
    state = 'CA';
</code></pre><p>当使用 <code>INSERT</code> 语句向一个表中添加多个行时，如果在处理过程中出现错误，<code>MySQL</code> 将终止该语句并返回一个错误，表中不会插入任何行。</p><p>使用 <code>INSERT IGNORE</code> 语句，则会忽略导致错误的包含无效数据的行，并将包含有效数据的行插入到表中。</p><pre class="language-mysql"><code class="language-mysql">CREATE TABLE subscribers (
    id INT PRIMARY KEY AUTO_INCREMENT,
    email VARCHAR(50) NOT NULL UNIQUE
);

INSERT IGNORE INTO subscribers(email)
VALUES('john.doe@gmail.com'),
      ('john.doe@gmail.com');
</code></pre><h4 id="2、UPDATE"><a href="#2、UPDATE" class="headerlink" title="2、UPDATE"></a>2、UPDATE</h4><p><code>UPDATE</code> 语句用于修改表中的现有数据。</p><p>语法：</p><pre class="language-mysql"><code class="language-mysql">UPDATE [LOW_PRIORITY] [IGNORE] table_name
SET
    column_name1 = expr1,
    column_name2 = expr2,
    ...
[WHERE
    condition];
</code></pre><p>例子：</p><pre class="language-mysql"><code class="language-mysql">UPDATE employees
SET
    email = 'mary.patterson@classicmodelcars.com'
WHERE
    employeeNumber = 1056;

SELECT
    firstname,
    lastname,
    email
FROM
    employees
WHERE
    employeeNumber = 1056;
</code></pre><p>更新多列数据：</p><pre class="language-mysql"><code class="language-mysql">UPDATE employees
SET
    lastname = 'Hill',
    email = 'mary.hill@classicmodelcars.com'
WHERE
    employeeNumber = 1056;

SELECT
    firstname,
    lastname,
    email
FROM
    employees
WHERE
    employeeNumber = 1056;
</code></pre><h4 id="3、UPDATE-JOIN"><a href="#3、UPDATE-JOIN" class="headerlink" title="3、UPDATE JOIN"></a>3、UPDATE JOIN</h4><p>使用 <code>UPDATE JOIN</code> 语句执行跨表更新。</p><p>准备数据：</p><pre class="language-mysql"><code class="language-mysql">CREATE DATABASE IF NOT EXISTS empdb;

USE empdb;

-- create tables
CREATE TABLE merits (
    performance INT(11) NOT NULL,
    percentage FLOAT NOT NULL,
    PRIMARY KEY (performance)
);

CREATE TABLE employees (
    emp_id INT(11) NOT NULL AUTO_INCREMENT,
    emp_name VARCHAR(255) NOT NULL,
    performance INT(11) DEFAULT NULL,
    salary FLOAT DEFAULT NULL,
    PRIMARY KEY (emp_id),
    CONSTRAINT fk_performance FOREIGN KEY (performance)
        REFERENCES merits (performance)
);
-- insert data for merits table
INSERT INTO merits(performance,percentage)
VALUES(1,0),
      (2,0.01),
      (3,0.03),
      (4,0.05),
      (5,0.08);
-- insert data for employees table
INSERT INTO employees(emp_name,performance,salary)
VALUES('Mary Doe', 1, 50000),
      ('Cindy Smith', 3, 65000),
      ('Sue Greenspan', 4, 75000),
      ('Grace Dell', 5, 125000),
      ('Nancy Johnson', 3, 85000),
      ('John Doe', 2, 45000),
      ('Lily Bush', 3, 55000);
</code></pre><p>跨表更新：</p><pre class="language-mysql"><code class="language-mysql">UPDATE employees
        INNER JOIN
    merits ON employees.performance = merits.performance
SET
    salary = salary + salary * percentage;
</code></pre><h4 id="4、DELETE"><a href="#4、DELETE" class="headerlink" title="4、DELETE"></a>4、DELETE</h4><p>删除表中的数据。</p><pre class="language-mysql"><code class="language-mysql">DELETE FROM customers
WHERE country = 'France'
ORDER BY creditLimit
LIMIT 5;
</code></pre><p>如果有外键约束，则无法删除数据，需要先删除外键约束。</p><h4 id="5、DELETE-JOIN"><a href="#5、DELETE-JOIN" class="headerlink" title="5、DELETE JOIN"></a>5、DELETE JOIN</h4><p>联表删除。</p><pre class="language-mysql"><code class="language-mysql">DELETE customers
FROM customers
        LEFT JOIN
    orders ON customers.customerNumber = orders.customerNumber
WHERE
    orderNumber IS NULL;

SELECT
    c.customerNumber,
    c.customerName,
    orderNumber
FROM
    customers c
        LEFT JOIN
    orders o ON c.customerNumber = o.customerNumber
WHERE
    orderNumber IS NULL;
</code></pre><h4 id="6、REPLACE"><a href="#6、REPLACE" class="headerlink" title="6、REPLACE"></a>6、REPLACE</h4><p>使用 <code>REPLACE</code> 语句可以在数据库表中插入或更新数据。</p><p><code>REPLACE</code>语句的工作原理如下：</p><ul><li>如果给定行数据不存在，那么 <code>REPLACE</code> 语句会插入一个新行；</li><li>如果给定行数据存在，则 <code>REPLACE</code> 语句首先删除旧行，然后插入一个新行。</li></ul><pre class="language-mysql"><code class="language-mysql">CREATE TABLE cities (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50),
    population INT NOT NULL
);

INSERT INTO cities(name,population)
VALUES('New York',8008278),
      ('Los Angeles',3694825),
      ('San Diego',1223405);

SELECT * from cities;

REPLACE INTO cities(id,population)
VALUES(2,3696820);
</code></pre><p>因为 <code>2</code> 已经存在，所以先删除这一条数据，因为没有设置 <code>name</code> 的值，所以插入后的第二条数据 <code>name</code> 为 <code>null</code>。</p><p>使用 <code>REPLACE</code> 更新一条数据：</p><pre class="language-mysql"><code class="language-mysql">REPLACE INTO cities
SET id = 4,
    name = 'Phoenix',
    population = 1768980;
</code></pre><p>使用 <code>REPLACE</code> 拷贝一条数据：</p><pre class="language-mysql"><code class="language-mysql">REPLACE INTO
    cities(name,population)
SELECT
    name,
    population
FROM
   cities
WHERE id = 1;
</code></pre><h3 id="八、最后"><a href="#八、最后" class="headerlink" title="八、最后"></a>八、最后</h3><p>参考：<a href="https://www.mysqltutorial.org/basic-mysql-tutorial.aspx" target="_blank" rel="noopener">https://www.mysqltutorial.org/basic-mysql-tutorial.aspx</a></p></div><hr><style>#reward{margin:40px 0;text-align:center}#reward .reward-link{font-size:1.88rem}#reward .btn-floating:hover{box-shadow:0 6px 12px rgba(0,0,0,.2),0 5px 15px rgba(0,0,0,.2)}#rewardModal{width:320px;height:350px}#rewardModal .reward-title{margin:15px auto;padding-bottom:5px}#rewardModal .modal-content{padding:10px}#rewardModal .close{position:absolute;right:15px;top:15px;color:rgba(0,0,0,.5);font-size:1.3rem;line-height:20px;cursor:pointer}#rewardModal .reward-tabs{margin:0 auto;width:210px}.reward-tabs .tabs{height:38px;margin:10px auto;padding-left:0}.reward-tabs .tabs .tab{height:38px;line-height:38px}.reward-tabs .tab a{color:#fff;background-color:#ccc}.reward-tabs .tab a:hover{color:#fff}.reward-tabs .wechat-tab .active{color:#fff;background-color:#22ab38}.reward-tabs .alipay-tab .active{color:#fff;background-color:#019fe8}.reward-tabs .reward-img{width:210px;height:210px}</style><div id="reward"> <a class="reward-link btn-floating btn-large waves-effect waves-light red">赏</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close"><i class="fa fa-close"></i></a><h4 class="reward-title">请我喝杯咖啡?</h4><div class="reward-content"><div class="reward-tabs"><ul class="tabs"><li class="tab wechat-tab waves-effect waves-light"><a class="active" href="#wechat">微信</a></li><li class="tab alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li></ul><div id="wechat"> <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码"></div><div id="alipay"> <img src="/medias/reward/alipay.png" class="reward-img" alt="支付宝打赏二维码"></div></div></div></div></div></div><script>$(function(){$("#reward .reward-link").on("click",function(){$("#rewardModal").openModal()}),$("#rewardModal .close").on("click",function(){$("#rewardModal").closeModal()})})</script><link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div></div><script src="/libs/share/js/social-share.min.js"></script><div class="reprint"><p> <span class="reprint-tip">转载请注明:</span> <a href="https://togoblog.cn" class="b-link-green">Deepspace</a><i class="fa fa-angle-right fa-lg fa-fw text-color"></i> <a href="/mysql-note/" class="b-link-green">MySQL 笔记</a></p></div></div></div><div class="article" data-aos="fade-up"><div class="card relate-article-wrapper"><header class="relate-article-header">相关文章&nbsp;<i class="fa fa-arrow-right"></i></header><div class="relate-post-box"><div class="relate-post"> <span>1、</span><a id="relate-post-link" href="/oracle-id-increase/">Oracle批量插入数据时ID自增问题</a></div></div></div></div><div class="disqus-card card" data-aos="fade-up"><div id="disqus_thread" class="card-content"><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div><script type="text/javascript">
    disqus_config = function () {
        this.page.url = 'https://togoblog.cn/mysql-note/';
        this.page.identifier = '/mysql-note/';
        this.page.title = 'MySQL 笔记';
    };
    let disqus_shortname = 'https-togoblog-cn';

    (function () { // DON'T EDIT BELOW THIS LINE
        let d = document, s = d.createElement('script');
        // 如：s.src = 'https://Deepspace.disqus.com/embed.js';
        s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script></div></div><div class="col l3 hide-on-med-and-down"><div class="toc-widget"><div class="toc-title">目录</div><div id="toc-content"></div></div></div></div><script src="/libs/tocbot/tocbot.min.js"></script><script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingSelector: 'h2, h3, h4, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });
    });
</script></main><footer class="page-footer bg-color"><div class="container row center-align"><div class="col s12 m8 l8 copy-right"> <span>COPYRIGHT 2020 DEEPSPACE. ALL RIGHTS RESERVED.</span></div><div class="col s12 m4 l4 social-link"><a href="https://github.com/IDeepspace" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fa fa-github"></i></a><a href="mailto:cxin1427@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fa fa-envelope-open"></i></a><a href="#!" class="tooltipped" data-tooltip="QQ: 690862036" data-position="top" data-delay="50"><i class="fa fa-qq"></i></a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fa fa-rss"></i></a></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"> <span class="title">搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input" autofocus></div><div id="searchResult"></div></div></div><script src="/js/search.js"></script><script type="text/javascript">searchFunc("/search.xml","searchInput","searchResult")</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fa fa-angle-up"></i></a></div><script src="/libs/materialize/js/materialize.min.js"></script><script src="/libs/masonry/masonry.pkgd.min.js"></script><script src="/libs/aos/aos.js"></script><script src="/libs/scrollprogress/scrollProgress.min.js"></script><script src="/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="/js/matery.js"></script></body></html>